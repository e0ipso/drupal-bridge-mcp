# Nixpacks configuration for Railway deployment
# This provides additional build and runtime configuration for the MCP Server

[variables]
NODE_ENV = "production"
NPM_CONFIG_PRODUCTION = "false" # Allow dev dependencies during build

[phases.build]
# Use custom build commands to ensure TypeScript compilation
cmds = [
  "npm ci --frozen-lockfile",
  "npm run build:prod"
]

[phases.install]
# Install only production dependencies after build
cmds = ["npm ci --frozen-lockfile --only=production"]

[start]
# Use the compiled JavaScript entry point
cmd = "node dist/index.js"

# Health check configuration
[healthcheck]
path = "/health"