77d453240614bf53510d2a7482a4bba5
"use strict";
/**
 * OAuth 2.1 Performance and Latency Validation Tests
 *
 * Tests performance characteristics of the OAuth 2.1 implementation:
 * - Authentication flow latency requirements
 * - PKCE challenge generation performance
 * - Endpoint discovery performance
 * - Token exchange throughput
 * - Memory usage optimization
 * - Concurrent authentication handling
 */
Object.defineProperty(exports, "__esModule", { value: true });
const globals_1 = require("@jest/globals");
const oauth_client_js_1 = require("@/auth/oauth-client.js");
const endpoint_discovery_js_1 = require("@/auth/endpoint-discovery.js");
const http_1 = require("http");
(0, globals_1.describe)('OAuth 2.1 Performance and Latency Tests', () => {
    let mockOAuthServer;
    let serverPort;
    let oauthClient;
    (0, globals_1.beforeAll)(async () => {
        mockOAuthServer = await createPerformanceTestServer();
        const address = mockOAuthServer.address();
        serverPort = address.port;
        oauthClient = new oauth_client_js_1.OAuthClient({
            clientId: 'test-client-id',
            authorizationEndpoint: `http://localhost:${serverPort}/oauth/authorize`,
            tokenEndpoint: `http://localhost:${serverPort}/oauth/token`,
            redirectUri: 'http://127.0.0.1:3000/callback',
            scopes: ['tutorial:read', 'user:profile'],
        });
    });
    (0, globals_1.afterAll)(async () => {
        if (mockOAuthServer) {
            await new Promise(resolve => {
                mockOAuthServer.close(() => resolve());
            });
        }
    });
    (0, globals_1.beforeEach)(() => {
        globals_1.jest.clearAllMocks();
        (0, endpoint_discovery_js_1.clearDiscoveryCache)();
    });
    (0, globals_1.describe)('PKCE Performance Benchmarks', () => {
        (0, globals_1.test)('should generate PKCE challenge within acceptable time limits', () => {
            const iterations = 1000;
            const startTime = performance.now();
            for (let i = 0; i < iterations; i++) {
                oauthClient.generatePKCEChallenge();
            }
            const endTime = performance.now();
            const totalTime = endTime - startTime;
            const averageTime = totalTime / iterations;
            // Should generate PKCE challenge in under 1ms on average
            (0, globals_1.expect)(averageTime).toBeLessThan(1);
            // Total time for 1000 generations should be under 100ms
            (0, globals_1.expect)(totalTime).toBeLessThan(100);
            console.log(`PKCE generation: ${averageTime.toFixed(3)}ms average, ${totalTime.toFixed(1)}ms total`);
        });
        (0, globals_1.test)('should maintain consistent PKCE generation performance', () => {
            const measurements = [];
            const batches = 10;
            const batchSize = 100;
            for (let batch = 0; batch < batches; batch++) {
                const startTime = performance.now();
                for (let i = 0; i < batchSize; i++) {
                    oauthClient.generatePKCEChallenge();
                }
                const endTime = performance.now();
                measurements.push(endTime - startTime);
            }
            const averageTime = measurements.reduce((a, b) => a + b, 0) / measurements.length;
            const maxTime = Math.max(...measurements);
            const minTime = Math.min(...measurements);
            // Performance should be consistent (max shouldn't be more than 5x min)
            (0, globals_1.expect)(maxTime / minTime).toBeLessThan(5);
            // Average batch time should be reasonable
            (0, globals_1.expect)(averageTime).toBeLessThan(50);
            console.log(`PKCE consistency: avg=${averageTime.toFixed(1)}ms, min=${minTime.toFixed(1)}ms, max=${maxTime.toFixed(1)}ms`);
        });
        (0, globals_1.test)('should not consume excessive memory during PKCE generation', () => {
            const initialMemory = process.memoryUsage().heapUsed;
            const iterations = 10000;
            // Generate many PKCE challenges
            for (let i = 0; i < iterations; i++) {
                oauthClient.generatePKCEChallenge();
            }
            // Force garbage collection if available
            if (global.gc) {
                global.gc();
            }
            const finalMemory = process.memoryUsage().heapUsed;
            const memoryIncrease = (finalMemory - initialMemory) / 1024 / 1024; // MB
            // Memory increase should be minimal (less than 10MB for 10k generations)
            (0, globals_1.expect)(memoryIncrease).toBeLessThan(10);
            console.log(`PKCE memory usage: ${memoryIncrease.toFixed(2)}MB increase for ${iterations} generations`);
        });
    });
    (0, globals_1.describe)('Token Exchange Performance', () => {
        (0, globals_1.test)('should complete token exchange within latency requirements', async () => {
            const iterations = 50;
            const measurements = [];
            setMockTokenResponse({
                accessToken: 'test_access_token',
                refreshToken: 'test_refresh_token',
                tokenType: 'Bearer',
                expiresIn: 3600,
            });
            for (let i = 0; i < iterations; i++) {
                const challenge = oauthClient.generatePKCEChallenge();
                const startTime = performance.now();
                const exchangeMethod = oauthClient.exchangeCodeForTokens.bind(oauthClient);
                await exchangeMethod(`test_code_${i}`, challenge.codeVerifier);
                const endTime = performance.now();
                measurements.push(endTime - startTime);
            }
            const averageTime = measurements.reduce((a, b) => a + b, 0) / measurements.length;
            const maxTime = Math.max(...measurements);
            const p95Time = measurements.sort((a, b) => a - b)[Math.floor(measurements.length * 0.95)];
            // Average token exchange should be under 50ms
            (0, globals_1.expect)(averageTime).toBeLessThan(50);
            // 95th percentile should be under 100ms
            (0, globals_1.expect)(p95Time).toBeLessThan(100);
            // No single exchange should take more than 200ms
            (0, globals_1.expect)(maxTime).toBeLessThan(200);
            console.log(`Token exchange: avg=${averageTime.toFixed(1)}ms, p95=${p95Time.toFixed(1)}ms, max=${maxTime.toFixed(1)}ms`);
        });
        (0, globals_1.test)('should handle concurrent token exchanges efficiently', async () => {
            const concurrency = 10;
            const iterations = 5;
            setMockTokenResponse({
                accessToken: 'concurrent_access_token',
                tokenType: 'Bearer',
                expiresIn: 3600,
            });
            const startTime = performance.now();
            const promises = Array.from({ length: concurrency }, async (_, i) => {
                const measurements = [];
                for (let j = 0; j < iterations; j++) {
                    const challenge = oauthClient.generatePKCEChallenge();
                    const exchangeStart = performance.now();
                    const exchangeMethod = oauthClient.exchangeCodeForTokens.bind(oauthClient);
                    await exchangeMethod(`concurrent_code_${i}_${j}`, challenge.codeVerifier);
                    measurements.push(performance.now() - exchangeStart);
                }
                return measurements;
            });
            const results = await Promise.all(promises);
            const endTime = performance.now();
            const allMeasurements = results.flat();
            const averageTime = allMeasurements.reduce((a, b) => a + b, 0) / allMeasurements.length;
            const totalTime = endTime - startTime;
            // Concurrent operations shouldn't significantly degrade performance
            (0, globals_1.expect)(averageTime).toBeLessThan(100);
            // Total time should show concurrency benefit
            (0, globals_1.expect)(totalTime).toBeLessThan(concurrency * iterations * 50);
            console.log(`Concurrent exchanges: ${concurrency}x${iterations} in ${totalTime.toFixed(1)}ms, avg=${averageTime.toFixed(1)}ms`);
        });
        (0, globals_1.test)('should maintain performance under token refresh load', async () => {
            const iterations = 100;
            const measurements = [];
            setMockTokenResponse({
                accessToken: 'refreshed_access_token',
                refreshToken: 'new_refresh_token',
                tokenType: 'Bearer',
                expiresIn: 3600,
            });
            for (let i = 0; i < iterations; i++) {
                const startTime = performance.now();
                await oauthClient.refreshToken(`refresh_token_${i}`);
                const endTime = performance.now();
                measurements.push(endTime - startTime);
            }
            const averageTime = measurements.reduce((a, b) => a + b, 0) / measurements.length;
            const maxTime = Math.max(...measurements);
            // Token refresh should be consistently fast
            (0, globals_1.expect)(averageTime).toBeLessThan(30);
            (0, globals_1.expect)(maxTime).toBeLessThan(100);
            console.log(`Token refresh: avg=${averageTime.toFixed(1)}ms, max=${maxTime.toFixed(1)}ms for ${iterations} refreshes`);
        });
    });
    (0, globals_1.describe)('Endpoint Discovery Performance', () => {
        (0, globals_1.test)('should complete discovery within acceptable time limits', async () => {
            const iterations = 20;
            const measurements = [];
            setServerBehavior('fast_discovery');
            for (let i = 0; i < iterations; i++) {
                (0, endpoint_discovery_js_1.clearDiscoveryCache)(); // Force fresh discovery each time
                const startTime = performance.now();
                await (0, endpoint_discovery_js_1.discoverOAuthEndpoints)({
                    baseUrl: `http://localhost:${serverPort}`,
                    timeout: 5000,
                });
                const endTime = performance.now();
                measurements.push(endTime - startTime);
            }
            const averageTime = measurements.reduce((a, b) => a + b, 0) / measurements.length;
            const maxTime = Math.max(...measurements);
            // Discovery should be fast
            (0, globals_1.expect)(averageTime).toBeLessThan(100);
            (0, globals_1.expect)(maxTime).toBeLessThan(200);
            console.log(`Discovery: avg=${averageTime.toFixed(1)}ms, max=${maxTime.toFixed(1)}ms`);
        });
        (0, globals_1.test)('should demonstrate cache performance benefits', async () => {
            const iterations = 50;
            setServerBehavior('fast_discovery');
            // Measure first discovery (cache miss)
            (0, endpoint_discovery_js_1.clearDiscoveryCache)();
            const firstDiscoveryStart = performance.now();
            await (0, endpoint_discovery_js_1.discoverOAuthEndpoints)({
                baseUrl: `http://localhost:${serverPort}`,
                cacheTtl: 60000,
            });
            const firstDiscoveryTime = performance.now() - firstDiscoveryStart;
            // Measure cached discoveries
            const cachedMeasurements = [];
            for (let i = 0; i < iterations; i++) {
                const startTime = performance.now();
                await (0, endpoint_discovery_js_1.discoverOAuthEndpoints)({
                    baseUrl: `http://localhost:${serverPort}`,
                    cacheTtl: 60000,
                });
                const endTime = performance.now();
                cachedMeasurements.push(endTime - startTime);
            }
            const averageCachedTime = cachedMeasurements.reduce((a, b) => a + b, 0) /
                cachedMeasurements.length;
            // Cached access should be much faster than initial discovery
            (0, globals_1.expect)(averageCachedTime).toBeLessThan(firstDiscoveryTime / 5);
            (0, globals_1.expect)(averageCachedTime).toBeLessThan(5); // Should be very fast
            console.log(`Discovery cache: first=${firstDiscoveryTime.toFixed(1)}ms, cached avg=${averageCachedTime.toFixed(3)}ms`);
        });
        (0, globals_1.test)('should handle discovery fallback efficiently', async () => {
            const iterations = 10;
            const measurements = [];
            setServerBehavior('discovery_failure');
            for (let i = 0; i < iterations; i++) {
                (0, endpoint_discovery_js_1.clearDiscoveryCache)();
                const startTime = performance.now();
                const endpoints = await (0, endpoint_discovery_js_1.discoverOAuthEndpoints)({
                    baseUrl: `http://localhost:${serverPort}`,
                    timeout: 1000,
                    retries: 1,
                });
                const endTime = performance.now();
                measurements.push(endTime - startTime);
                (0, globals_1.expect)(endpoints.isFallback).toBe(true);
            }
            const averageTime = measurements.reduce((a, b) => a + b, 0) / measurements.length;
            // Fallback should complete within reasonable time
            (0, globals_1.expect)(averageTime).toBeLessThan(3000); // Should include timeout + retry
            console.log(`Discovery fallback: avg=${averageTime.toFixed(1)}ms`);
        });
    });
    (0, globals_1.describe)('Memory Usage Optimization', () => {
        (0, globals_1.test)('should not leak memory during repeated OAuth flows', async () => {
            const initialMemory = process.memoryUsage().heapUsed;
            const iterations = 100;
            setMockTokenResponse({
                accessToken: 'memory_test_token',
                tokenType: 'Bearer',
                expiresIn: 3600,
            });
            for (let i = 0; i < iterations; i++) {
                const challenge = oauthClient.generatePKCEChallenge();
                const exchangeMethod = oauthClient.exchangeCodeForTokens.bind(oauthClient);
                await exchangeMethod(`memory_test_code_${i}`, challenge.codeVerifier);
            }
            // Force garbage collection if available
            if (global.gc) {
                global.gc();
            }
            const finalMemory = process.memoryUsage().heapUsed;
            const memoryIncrease = (finalMemory - initialMemory) / 1024 / 1024; // MB
            // Memory increase should be minimal
            (0, globals_1.expect)(memoryIncrease).toBeLessThan(5);
            console.log(`OAuth flows memory: ${memoryIncrease.toFixed(2)}MB increase for ${iterations} flows`);
        });
        (0, globals_1.test)('should efficiently manage discovery cache memory', async () => {
            const initialMemory = process.memoryUsage().heapUsed;
            const baseUrls = Array.from({ length: 100 }, (_, i) => `http://localhost:${serverPort}/site${i}`);
            setServerBehavior('fast_discovery');
            // Fill cache with many entries
            for (const baseUrl of baseUrls) {
                await (0, endpoint_discovery_js_1.discoverOAuthEndpoints)({
                    baseUrl,
                    cacheTtl: 60000,
                });
            }
            if (global.gc) {
                global.gc();
            }
            const finalMemory = process.memoryUsage().heapUsed;
            const memoryIncrease = (finalMemory - initialMemory) / 1024 / 1024; // MB
            // Memory usage should be reasonable for cached data
            (0, globals_1.expect)(memoryIncrease).toBeLessThan(10);
            console.log(`Discovery cache memory: ${memoryIncrease.toFixed(2)}MB for ${baseUrls.length} cached entries`);
        });
    });
    (0, globals_1.describe)('Throughput Benchmarks', () => {
        (0, globals_1.test)('should achieve acceptable PKCE generation throughput', () => {
            const duration = 1000; // 1 second
            const startTime = performance.now();
            let count = 0;
            while (performance.now() - startTime < duration) {
                oauthClient.generatePKCEChallenge();
                count++;
            }
            const actualDuration = performance.now() - startTime;
            const throughput = (count / actualDuration) * 1000; // ops per second
            // Should generate at least 1000 PKCE challenges per second
            (0, globals_1.expect)(throughput).toBeGreaterThan(1000);
            console.log(`PKCE throughput: ${throughput.toFixed(0)} challenges/sec`);
        });
        (0, globals_1.test)('should handle high-frequency token operations', async () => {
            const operations = 100;
            const startTime = performance.now();
            setMockTokenResponse({
                accessToken: 'throughput_test_token',
                tokenType: 'Bearer',
                expiresIn: 3600,
            });
            const promises = Array.from({ length: operations }, async (_, i) => {
                const challenge = oauthClient.generatePKCEChallenge();
                const exchangeMethod = oauthClient.exchangeCodeForTokens.bind(oauthClient);
                return exchangeMethod(`throughput_code_${i}`, challenge.codeVerifier);
            });
            await Promise.all(promises);
            const endTime = performance.now();
            const duration = endTime - startTime;
            const throughput = (operations / duration) * 1000; // ops per second
            // Should handle significant token operation throughput
            (0, globals_1.expect)(throughput).toBeGreaterThan(10);
            console.log(`Token operation throughput: ${throughput.toFixed(1)} ops/sec`);
        });
    });
});
// Mock server implementation for performance testing
let serverBehavior = 'fast_discovery';
let mockTokenResponse = null;
function setServerBehavior(behavior) {
    serverBehavior = behavior;
}
function setMockTokenResponse(tokens) {
    mockTokenResponse = tokens;
}
async function createPerformanceTestServer() {
    return new Promise(resolve => {
        const server = (0, http_1.createServer)((req, res) => {
            const url = new URL(req.url || '', `http://localhost`);
            if (url.pathname === '/.well-known/oauth-authorization-server') {
                handlePerformanceDiscoveryRequest(req, res);
            }
            else if (url.pathname === '/oauth/token' && req.method === 'POST') {
                handlePerformanceTokenRequest(req, res);
            }
            else {
                res.writeHead(404);
                res.end('Not found');
            }
        });
        server.listen(0, '127.0.0.1', () => {
            resolve(server);
        });
    });
}
function handlePerformanceDiscoveryRequest(req, res) {
    const address = req.socket.address();
    const baseUrl = `http://localhost:${address.port}`;
    switch (serverBehavior) {
        case 'discovery_failure':
            res.writeHead(404);
            res.end('Not Found');
            break;
        case 'fast_discovery':
        default:
            res.writeHead(200, { 'Content-Type': 'application/json' });
            res.end(JSON.stringify({
                issuer: baseUrl,
                authorization_endpoint: `${baseUrl}/oauth/authorize`,
                token_endpoint: `${baseUrl}/oauth/token`,
                response_types_supported: ['code'],
                grant_types_supported: ['authorization_code', 'refresh_token'],
                code_challenge_methods_supported: ['S256'],
            }));
    }
}
function handlePerformanceTokenRequest(req, res) {
    if (mockTokenResponse) {
        res.writeHead(200, { 'Content-Type': 'application/json' });
        res.end(JSON.stringify({
            access_token: mockTokenResponse.accessToken,
            refresh_token: mockTokenResponse.refreshToken,
            token_type: mockTokenResponse.tokenType,
            expires_in: mockTokenResponse.expiresIn,
            scope: mockTokenResponse.scope,
        }));
    }
    else {
        res.writeHead(500, { 'Content-Type': 'application/json' });
        res.end(JSON.stringify({ error: 'server_error' }));
    }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL3dvcmtzcGFjZS90ZXN0cy9pbnRlZ3JhdGlvbi9vYXV0aC1wZXJmb3JtYW5jZS50ZXN0LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7Ozs7OztHQVVHOztBQUVILDJDQVN1QjtBQUN2Qiw0REFBcUQ7QUFDckQsd0VBR3NDO0FBRXRDLCtCQUFvQztBQUlwQyxJQUFBLGtCQUFRLEVBQUMseUNBQXlDLEVBQUUsR0FBRyxFQUFFO0lBQ3ZELElBQUksZUFBdUIsQ0FBQztJQUM1QixJQUFJLFVBQWtCLENBQUM7SUFDdkIsSUFBSSxXQUF3QixDQUFDO0lBRTdCLElBQUEsbUJBQVMsRUFBQyxLQUFLLElBQUksRUFBRTtRQUNuQixlQUFlLEdBQUcsTUFBTSwyQkFBMkIsRUFBRSxDQUFDO1FBQ3RELE1BQU0sT0FBTyxHQUFHLGVBQWUsQ0FBQyxPQUFPLEVBQWlCLENBQUM7UUFDekQsVUFBVSxHQUFHLE9BQU8sQ0FBQyxJQUFJLENBQUM7UUFFMUIsV0FBVyxHQUFHLElBQUksNkJBQVcsQ0FBQztZQUM1QixRQUFRLEVBQUUsZ0JBQWdCO1lBQzFCLHFCQUFxQixFQUFFLG9CQUFvQixVQUFVLGtCQUFrQjtZQUN2RSxhQUFhLEVBQUUsb0JBQW9CLFVBQVUsY0FBYztZQUMzRCxXQUFXLEVBQUUsZ0NBQWdDO1lBQzdDLE1BQU0sRUFBRSxDQUFDLGVBQWUsRUFBRSxjQUFjLENBQUM7U0FDMUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFBLGtCQUFRLEVBQUMsS0FBSyxJQUFJLEVBQUU7UUFDbEIsSUFBSSxlQUFlLEVBQUUsQ0FBQztZQUNwQixNQUFNLElBQUksT0FBTyxDQUFPLE9BQU8sQ0FBQyxFQUFFO2dCQUNoQyxlQUFlLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRSxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUM7WUFDekMsQ0FBQyxDQUFDLENBQUM7UUFDTCxDQUFDO0lBQ0gsQ0FBQyxDQUFDLENBQUM7SUFFSCxJQUFBLG9CQUFVLEVBQUMsR0FBRyxFQUFFO1FBQ2QsY0FBSSxD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Z0JBQ2IsTUFBTSxFQUFFLE9BQU87Z0JBQ2Ysc0JBQXNCLEVBQUUsR0FBRyxPQUFPLGtCQUFrQjtnQkFDcEQsY0FBYyxFQUFFLEdBQUcsT0FBTyxjQUFjO2dCQUN4Qyx3QkFBd0IsRUFBRSxDQUFDLE1BQU0sQ0FBQztnQkFDbEMscUJBQXFCLEVBQUUsQ0FBQyxvQkFBb0IsRUFBRSxlQUFlLENBQUM7Z0JBQzlELGdDQUFnQyxFQUFFLENBQUMsTUFBTSxDQUFDO2FBQzNDLENBQUMsQ0FDSCxDQUFDO0lBQ04sQ0FBQztBQUNILENBQUM7QUFFRCxTQUFTLDZCQUE2QixDQUFDLEdBQVEsRUFBRSxHQUFRO0lBQ3ZELElBQUksaUJBQWlCLEVBQUUsQ0FBQztRQUN0QixHQUFHLENBQUMsU0FBUyxDQUFDLEdBQUcsRUFBRSxFQUFFLGNBQWMsRUFBRSxrQkFBa0IsRUFBRSxDQUFDLENBQUM7UUFDM0QsR0FBRyxDQUFDLEdBQUcsQ0FDTCxJQUFJLENBQUMsU0FBUyxDQUFDO1lBQ2IsWUFBWSxFQUFFLGlCQUFpQixDQUFDLFdBQVc7WUFDM0MsYUFBYSxFQUFFLGlCQUFpQixDQUFDLFlBQVk7WUFDN0MsVUFBVSxFQUFFLGlCQUFpQixDQUFDLFNBQVM7WUFDdkMsVUFBVSxFQUFFLGlCQUFpQixDQUFDLFNBQVM7WUFDdkMsS0FBSyxFQUFFLGlCQUFpQixDQUFDLEtBQUs7U0FDL0IsQ0FBQyxDQUNILENBQUM7SUFDSixDQUFDO1NBQU0sQ0FBQztRQUNOLEdBQUcsQ0FBQyxTQUFTLENBQUMsR0FBRyxFQUFFLEVBQUUsY0FBYyxFQUFFLGtCQUFrQixFQUFFLENBQUMsQ0FBQztRQUMzRCxHQUFHLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxLQUFLLEVBQUUsY0FBYyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ3JELENBQUM7QUFDSCxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi93b3Jrc3BhY2UvdGVzdHMvaW50ZWdyYXRpb24vb2F1dGgtcGVyZm9ybWFuY2UudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIE9BdXRoIDIuMSBQZXJmb3JtYW5jZSBhbmQgTGF0ZW5jeSBWYWxpZGF0aW9uIFRlc3RzXG4gKlxuICogVGVzdHMgcGVyZm9ybWFuY2UgY2hhcmFjdGVyaXN0aWNzIG9mIHRoZSBPQXV0aCAyLjEgaW1wbGVtZW50YXRpb246XG4gKiAtIEF1dGhlbnRpY2F0aW9uIGZsb3cgbGF0ZW5jeSByZXF1aXJlbWVudHNcbiAqIC0gUEtDRSBjaGFsbGVuZ2UgZ2VuZXJhdGlvbiBwZXJmb3JtYW5jZVxuICogLSBFbmRwb2ludCBkaXNjb3ZlcnkgcGVyZm9ybWFuY2VcbiAqIC0gVG9rZW4gZXhjaGFuZ2UgdGhyb3VnaHB1dFxuICogLSBNZW1vcnkgdXNhZ2Ugb3B0aW1pemF0aW9uXG4gKiAtIENvbmN1cnJlbnQgYXV0aGVudGljYXRpb24gaGFuZGxpbmdcbiAqL1xuXG5pbXBvcnQge1xuICBkZXNjcmliZSxcbiAgdGVzdCxcbiAgZXhwZWN0LFxuICBiZWZvcmVFYWNoLFxuICBhZnRlckVhY2gsXG4gIGplc3QsXG4gIGJlZm9yZUFsbCxcbiAgYWZ0ZXJBbGwsXG59IGZyb20gJ0BqZXN0L2dsb2JhbHMnO1xuaW1wb3J0IHsgT0F1dGhDbGllbnQgfSBmcm9tICdAL2F1dGgvb2F1dGgtY2xpZW50LmpzJztcbmltcG9ydCB7XG4gIGRpc2NvdmVyT0F1dGhFbmRwb2ludHMsXG4gIGNsZWFyRGlzY292ZXJ5Q2FjaGUsXG59IGZyb20gJ0AvYXV0aC9lbmRwb2ludC1kaXNjb3ZlcnkuanMnO1xuaW1wb3J0IHR5cGUgeyBPQXV0aFRva2VucyB9IGZyb20gJ0AvYXV0aC9vYXV0aC1jbGllbnQuanMnO1xuaW1wb3J0IHsgY3JlYXRlU2VydmVyIH0gZnJvbSAnaHR0cCc7XG5pbXBvcnQgdHlwZSB7IFNlcnZlciB9IGZyb20gJ2h0dHAnO1xuaW1wb3J0IHR5cGUgeyBBZGRyZXNzSW5mbyB9IGZyb20gJ25ldCc7XG5cbmRlc2NyaWJlKCdPQXV0aCAyLjEgUGVyZm9ybWFuY2UgYW5kIExhdGVuY3kgVGVzdHMnLCAoKSA9PiB7XG4gIGxldCBtb2NrT0F1dGhTZXJ2ZXI6IFNlcnZlcjtcbiAgbGV0IHNlcnZlclBvcnQ6IG51bWJlcjtcbiAgbGV0IG9hdXRoQ2xpZW50OiBPQXV0aENsaWVudDtcblxuICBiZWZvcmVBbGwoYXN5bmMgKCkgPT4ge1xuICAgIG1vY2tPQXV0aFNlcnZlciA9IGF3YWl0IGNyZWF0ZVBlcmZvcm1hbmNlVGVzdFNlcnZlcigpO1xuICAgIGNvbnN0IGFkZHJlc3MgPSBtb2NrT0F1dGhTZXJ2ZXIuYWRkcmVzcygpIGFzIEFkZHJlc3NJbmZvO1xuICAgIHNlcnZlclBvcnQgPSBhZGRyZXNzLnBvcnQ7XG5cbiAgICBvYXV0aENsaWVudCA9IG5ldyBPQXV0aENsaWVudCh7XG4gICAgICBjbGllbnRJZDogJ3Rlc3QtY2xpZW50LWlkJyxcbiAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogYGh0dHA6Ly9sb2NhbGhvc3Q6JHtzZXJ2ZXJQb3J0fS9vYXV0aC9hdXRob3JpemVgLFxuICAgICAgdG9rZW5FbmRwb2ludDogYGh0dHA6Ly9sb2NhbGhvc3Q6JHtzZXJ2ZXJQb3J0fS9vYXV0aC90b2tlbmAsXG4gICAgICByZWRpcmVjdFVyaTogJ2h0dHA6Ly8xMjcuMC4wLjE6MzAwMC9jYWxsYmFjaycsXG4gICAgICBzY29wZXM6IFsndHV0b3JpYWw6cmVhZCcsICd1c2VyOnByb2ZpbGUnXSxcbiAgICB9KTtcbiAgfSk7XG5cbiAgYWZ0ZXJBbGwoYXN5bmMgKCkgPT4ge1xuICAgIGlmIChtb2NrT0F1dGhTZXJ2ZXIpIHtcbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlPHZvaWQ+KHJlc29sdmUgPT4ge1xuICAgICAgICBtb2NrT0F1dGhTZXJ2ZXIuY2xvc2UoKCkgPT4gcmVzb2x2ZSgpKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XG4gICAgY2xlYXJEaXNjb3ZlcnlDYWNoZSgpO1xuICB9KTtcblxuICBkZXNjcmliZSgnUEtDRSBQZXJmb3JtYW5jZSBCZW5jaG1hcmtzJywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCBnZW5lcmF0ZSBQS0NFIGNoYWxsZW5nZSB3aXRoaW4gYWNjZXB0YWJsZSB0aW1lIGxpbWl0cycsICgpID0+IHtcbiAgICAgIGNvbnN0IGl0ZXJhdGlvbnMgPSAxMDAwO1xuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG5cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlcmF0aW9uczsgaSsrKSB7XG4gICAgICAgIG9hdXRoQ2xpZW50LmdlbmVyYXRlUEtDRUNoYWxsZW5nZSgpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBlbmRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICBjb25zdCB0b3RhbFRpbWUgPSBlbmRUaW1lIC0gc3RhcnRUaW1lO1xuICAgICAgY29uc3QgYXZlcmFnZVRpbWUgPSB0b3RhbFRpbWUgLyBpdGVyYXRpb25zO1xuXG4gICAgICAvLyBTaG91bGQgZ2VuZXJhdGUgUEtDRSBjaGFsbGVuZ2UgaW4gdW5kZXIgMW1zIG9uIGF2ZXJhZ2VcbiAgICAgIGV4cGVjdChhdmVyYWdlVGltZSkudG9CZUxlc3NUaGFuKDEpO1xuXG4gICAgICAvLyBUb3RhbCB0aW1lIGZvciAxMDAwIGdlbmVyYXRpb25zIHNob3VsZCBiZSB1bmRlciAxMDBtc1xuICAgICAgZXhwZWN0KHRvdGFsVGltZSkudG9CZUxlc3NUaGFuKDEwMCk7XG5cbiAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICBgUEtDRSBnZW5lcmF0aW9uOiAke2F2ZXJhZ2VUaW1lLnRvRml4ZWQoMyl9bXMgYXZlcmFnZSwgJHt0b3RhbFRpbWUudG9GaXhlZCgxKX1tcyB0b3RhbGBcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgbWFpbnRhaW4gY29uc2lzdGVudCBQS0NFIGdlbmVyYXRpb24gcGVyZm9ybWFuY2UnLCAoKSA9PiB7XG4gICAgICBjb25zdCBtZWFzdXJlbWVudHM6IG51bWJlcltdID0gW107XG4gICAgICBjb25zdCBiYXRjaGVzID0gMTA7XG4gICAgICBjb25zdCBiYXRjaFNpemUgPSAxMDA7XG5cbiAgICAgIGZvciAobGV0IGJhdGNoID0gMDsgYmF0Y2ggPCBiYXRjaGVzOyBiYXRjaCsrKSB7XG4gICAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IHBlcmZvcm1hbmNlLm5vdygpO1xuXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmF0Y2hTaXplOyBpKyspIHtcbiAgICAgICAgICBvYXV0aENsaWVudC5nZW5lcmF0ZVBLQ0VDaGFsbGVuZ2UoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGVuZFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICAgICAgbWVhc3VyZW1lbnRzLnB1c2goZW5kVGltZSAtIHN0YXJ0VGltZSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGF2ZXJhZ2VUaW1lID1cbiAgICAgICAgbWVhc3VyZW1lbnRzLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApIC8gbWVhc3VyZW1lbnRzLmxlbmd0aDtcbiAgICAgIGNvbnN0IG1heFRpbWUgPSBNYXRoLm1heCguLi5tZWFzdXJlbWVudHMpO1xuICAgICAgY29uc3QgbWluVGltZSA9IE1hdGgubWluKC4uLm1lYXN1cmVtZW50cyk7XG5cbiAgICAgIC8vIFBlcmZvcm1hbmNlIHNob3VsZCBiZSBjb25zaXN0ZW50IChtYXggc2hvdWxkbid0IGJlIG1vcmUgdGhhbiA1eCBtaW4pXG4gICAgICBleHBlY3QobWF4VGltZSAvIG1pblRpbWUpLnRvQmVMZXNzVGhhbig1KTtcblxuICAgICAgLy8gQXZlcmFnZSBiYXRjaCB0aW1lIHNob3VsZCBiZSByZWFzb25hYmxlXG4gICAgICBleHBlY3QoYXZlcmFnZVRpbWUpLnRvQmVMZXNzVGhhbig1MCk7XG5cbiAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICBgUEtDRSBjb25zaXN0ZW5jeTogYXZnPSR7YXZlcmFnZVRpbWUudG9GaXhlZCgxKX1tcywgbWluPSR7bWluVGltZS50b0ZpeGVkKDEpfW1zLCBtYXg9JHttYXhUaW1lLnRvRml4ZWQoMSl9bXNgXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIG5vdCBjb25zdW1lIGV4Y2Vzc2l2ZSBtZW1vcnkgZHVyaW5nIFBLQ0UgZ2VuZXJhdGlvbicsICgpID0+IHtcbiAgICAgIGNvbnN0IGluaXRpYWxNZW1vcnkgPSBwcm9jZXNzLm1lbW9yeVVzYWdlKCkuaGVhcFVzZWQ7XG4gICAgICBjb25zdCBpdGVyYXRpb25zID0gMTAwMDA7XG5cbiAgICAgIC8vIEdlbmVyYXRlIG1hbnkgUEtDRSBjaGFsbGVuZ2VzXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZXJhdGlvbnM7IGkrKykge1xuICAgICAgICBvYXV0aENsaWVudC5nZW5lcmF0ZVBLQ0VDaGFsbGVuZ2UoKTtcbiAgICAgIH1cblxuICAgICAgLy8gRm9yY2UgZ2FyYmFnZSBjb2xsZWN0aW9uIGlmIGF2YWlsYWJsZVxuICAgICAgaWYgKGdsb2JhbC5nYykge1xuICAgICAgICBnbG9iYWwuZ2MoKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZmluYWxNZW1vcnkgPSBwcm9jZXNzLm1lbW9yeVVzYWdlKCkuaGVhcFVzZWQ7XG4gICAgICBjb25zdCBtZW1vcnlJbmNyZWFzZSA9IChmaW5hbE1lbW9yeSAtIGluaXRpYWxNZW1vcnkpIC8gMTAyNCAvIDEwMjQ7IC8vIE1CXG5cbiAgICAgIC8vIE1lbW9yeSBpbmNyZWFzZSBzaG91bGQgYmUgbWluaW1hbCAobGVzcyB0aGFuIDEwTUIgZm9yIDEwayBnZW5lcmF0aW9ucylcbiAgICAgIGV4cGVjdChtZW1vcnlJbmNyZWFzZSkudG9CZUxlc3NUaGFuKDEwKTtcblxuICAgICAgY29uc29sZS5sb2coXG4gICAgICAgIGBQS0NFIG1lbW9yeSB1c2FnZTogJHttZW1vcnlJbmNyZWFzZS50b0ZpeGVkKDIpfU1CIGluY3JlYXNlIGZvciAke2l0ZXJhdGlvbnN9IGdlbmVyYXRpb25zYFxuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1Rva2VuIEV4Y2hhbmdlIFBlcmZvcm1hbmNlJywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCBjb21wbGV0ZSB0b2tlbiBleGNoYW5nZSB3aXRoaW4gbGF0ZW5jeSByZXF1aXJlbWVudHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBpdGVyYXRpb25zID0gNTA7XG4gICAgICBjb25zdCBtZWFzdXJlbWVudHM6IG51bWJlcltdID0gW107XG5cbiAgICAgIHNldE1vY2tUb2tlblJlc3BvbnNlKHtcbiAgICAgICAgYWNjZXNzVG9rZW46ICd0ZXN0X2FjY2Vzc190b2tlbicsXG4gICAgICAgIHJlZnJlc2hUb2tlbjogJ3Rlc3RfcmVmcmVzaF90b2tlbicsXG4gICAgICAgIHRva2VuVHlwZTogJ0JlYXJlcicsXG4gICAgICAgIGV4cGlyZXNJbjogMzYwMCxcbiAgICAgIH0pO1xuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZXJhdGlvbnM7IGkrKykge1xuICAgICAgICBjb25zdCBjaGFsbGVuZ2UgPSBvYXV0aENsaWVudC5nZW5lcmF0ZVBLQ0VDaGFsbGVuZ2UoKTtcbiAgICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG5cbiAgICAgICAgY29uc3QgZXhjaGFuZ2VNZXRob2QgPSAob2F1dGhDbGllbnQgYXMgYW55KS5leGNoYW5nZUNvZGVGb3JUb2tlbnMuYmluZChcbiAgICAgICAgICBvYXV0aENsaWVudFxuICAgICAgICApO1xuXG4gICAgICAgIGF3YWl0IGV4Y2hhbmdlTWV0aG9kKGB0ZXN0X2NvZGVfJHtpfWAsIGNoYWxsZW5nZS5jb2RlVmVyaWZpZXIpO1xuXG4gICAgICAgIGNvbnN0IGVuZFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICAgICAgbWVhc3VyZW1lbnRzLnB1c2goZW5kVGltZSAtIHN0YXJ0VGltZSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGF2ZXJhZ2VUaW1lID1cbiAgICAgICAgbWVhc3VyZW1lbnRzLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApIC8gbWVhc3VyZW1lbnRzLmxlbmd0aDtcbiAgICAgIGNvbnN0IG1heFRpbWUgPSBNYXRoLm1heCguLi5tZWFzdXJlbWVudHMpO1xuICAgICAgY29uc3QgcDk1VGltZSA9IG1lYXN1cmVtZW50cy5zb3J0KChhLCBiKSA9PiBhIC0gYilbXG4gICAgICAgIE1hdGguZmxvb3IobWVhc3VyZW1lbnRzLmxlbmd0aCAqIDAuOTUpXG4gICAgICBdO1xuXG4gICAgICAvLyBBdmVyYWdlIHRva2VuIGV4Y2hhbmdlIHNob3VsZCBiZSB1bmRlciA1MG1zXG4gICAgICBleHBlY3QoYXZlcmFnZVRpbWUpLnRvQmVMZXNzVGhhbig1MCk7XG5cbiAgICAgIC8vIDk1dGggcGVyY2VudGlsZSBzaG91bGQgYmUgdW5kZXIgMTAwbXNcbiAgICAgIGV4cGVjdChwOTVUaW1lKS50b0JlTGVzc1RoYW4oMTAwKTtcblxuICAgICAgLy8gTm8gc2luZ2xlIGV4Y2hhbmdlIHNob3VsZCB0YWtlIG1vcmUgdGhhbiAyMDBtc1xuICAgICAgZXhwZWN0KG1heFRpbWUpLnRvQmVMZXNzVGhhbigyMDApO1xuXG4gICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgYFRva2VuIGV4Y2hhbmdlOiBhdmc9JHthdmVyYWdlVGltZS50b0ZpeGVkKDEpfW1zLCBwOTU9JHtwOTVUaW1lLnRvRml4ZWQoMSl9bXMsIG1heD0ke21heFRpbWUudG9GaXhlZCgxKX1tc2BcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIGNvbmN1cnJlbnQgdG9rZW4gZXhjaGFuZ2VzIGVmZmljaWVudGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgY29uY3VycmVuY3kgPSAxMDtcbiAgICAgIGNvbnN0IGl0ZXJhdGlvbnMgPSA1O1xuXG4gICAgICBzZXRNb2NrVG9rZW5SZXNwb25zZSh7XG4gICAgICAgIGFjY2Vzc1Rva2VuOiAnY29uY3VycmVudF9hY2Nlc3NfdG9rZW4nLFxuICAgICAgICB0b2tlblR5cGU6ICdCZWFyZXInLFxuICAgICAgICBleHBpcmVzSW46IDM2MDAsXG4gICAgICB9KTtcblxuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG5cbiAgICAgIGNvbnN0IHByb21pc2VzID0gQXJyYXkuZnJvbSh7IGxlbmd0aDogY29uY3VycmVuY3kgfSwgYXN5bmMgKF8sIGkpID0+IHtcbiAgICAgICAgY29uc3QgbWVhc3VyZW1lbnRzOiBudW1iZXJbXSA9IFtdO1xuXG4gICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgaXRlcmF0aW9uczsgaisrKSB7XG4gICAgICAgICAgY29uc3QgY2hhbGxlbmdlID0gb2F1dGhDbGllbnQuZ2VuZXJhdGVQS0NFQ2hhbGxlbmdlKCk7XG4gICAgICAgICAgY29uc3QgZXhjaGFuZ2VTdGFydCA9IHBlcmZvcm1hbmNlLm5vdygpO1xuXG4gICAgICAgICAgY29uc3QgZXhjaGFuZ2VNZXRob2QgPSAoXG4gICAgICAgICAgICBvYXV0aENsaWVudCBhcyBhbnlcbiAgICAgICAgICApLmV4Y2hhbmdlQ29kZUZvclRva2Vucy5iaW5kKG9hdXRoQ2xpZW50KTtcblxuICAgICAgICAgIGF3YWl0IGV4Y2hhbmdlTWV0aG9kKFxuICAgICAgICAgICAgYGNvbmN1cnJlbnRfY29kZV8ke2l9XyR7an1gLFxuICAgICAgICAgICAgY2hhbGxlbmdlLmNvZGVWZXJpZmllclxuICAgICAgICAgICk7XG5cbiAgICAgICAgICBtZWFzdXJlbWVudHMucHVzaChwZXJmb3JtYW5jZS5ub3coKSAtIGV4Y2hhbmdlU3RhcnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG1lYXN1cmVtZW50cztcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCByZXN1bHRzID0gYXdhaXQgUHJvbWlzZS5hbGwocHJvbWlzZXMpO1xuICAgICAgY29uc3QgZW5kVGltZSA9IHBlcmZvcm1hbmNlLm5vdygpO1xuXG4gICAgICBjb25zdCBhbGxNZWFzdXJlbWVudHMgPSByZXN1bHRzLmZsYXQoKTtcbiAgICAgIGNvbnN0IGF2ZXJhZ2VUaW1lID1cbiAgICAgICAgYWxsTWVhc3VyZW1lbnRzLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApIC8gYWxsTWVhc3VyZW1lbnRzLmxlbmd0aDtcbiAgICAgIGNvbnN0IHRvdGFsVGltZSA9IGVuZFRpbWUgLSBzdGFydFRpbWU7XG5cbiAgICAgIC8vIENvbmN1cnJlbnQgb3BlcmF0aW9ucyBzaG91bGRuJ3Qgc2lnbmlmaWNhbnRseSBkZWdyYWRlIHBlcmZvcm1hbmNlXG4gICAgICBleHBlY3QoYXZlcmFnZVRpbWUpLnRvQmVMZXNzVGhhbigxMDApO1xuXG4gICAgICAvLyBUb3RhbCB0aW1lIHNob3VsZCBzaG93IGNvbmN1cnJlbmN5IGJlbmVmaXRcbiAgICAgIGV4cGVjdCh0b3RhbFRpbWUpLnRvQmVMZXNzVGhhbihjb25jdXJyZW5jeSAqIGl0ZXJhdGlvbnMgKiA1MCk7XG5cbiAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICBgQ29uY3VycmVudCBleGNoYW5nZXM6ICR7Y29uY3VycmVuY3l9eCR7aXRlcmF0aW9uc30gaW4gJHt0b3RhbFRpbWUudG9GaXhlZCgxKX1tcywgYXZnPSR7YXZlcmFnZVRpbWUudG9GaXhlZCgxKX1tc2BcbiAgICAgICk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgbWFpbnRhaW4gcGVyZm9ybWFuY2UgdW5kZXIgdG9rZW4gcmVmcmVzaCBsb2FkJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgaXRlcmF0aW9ucyA9IDEwMDtcbiAgICAgIGNvbnN0IG1lYXN1cmVtZW50czogbnVtYmVyW10gPSBbXTtcblxuICAgICAgc2V0TW9ja1Rva2VuUmVzcG9uc2Uoe1xuICAgICAgICBhY2Nlc3NUb2tlbjogJ3JlZnJlc2hlZF9hY2Nlc3NfdG9rZW4nLFxuICAgICAgICByZWZyZXNoVG9rZW46ICduZXdfcmVmcmVzaF90b2tlbicsXG4gICAgICAgIHRva2VuVHlwZTogJ0JlYXJlcicsXG4gICAgICAgIGV4cGlyZXNJbjogMzYwMCxcbiAgICAgIH0pO1xuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZXJhdGlvbnM7IGkrKykge1xuICAgICAgICBjb25zdCBzdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcblxuICAgICAgICBhd2FpdCBvYXV0aENsaWVudC5yZWZyZXNoVG9rZW4oYHJlZnJlc2hfdG9rZW5fJHtpfWApO1xuXG4gICAgICAgIGNvbnN0IGVuZFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICAgICAgbWVhc3VyZW1lbnRzLnB1c2goZW5kVGltZSAtIHN0YXJ0VGltZSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGF2ZXJhZ2VUaW1lID1cbiAgICAgICAgbWVhc3VyZW1lbnRzLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApIC8gbWVhc3VyZW1lbnRzLmxlbmd0aDtcbiAgICAgIGNvbnN0IG1heFRpbWUgPSBNYXRoLm1heCguLi5tZWFzdXJlbWVudHMpO1xuXG4gICAgICAvLyBUb2tlbiByZWZyZXNoIHNob3VsZCBiZSBjb25zaXN0ZW50bHkgZmFzdFxuICAgICAgZXhwZWN0KGF2ZXJhZ2VUaW1lKS50b0JlTGVzc1RoYW4oMzApO1xuICAgICAgZXhwZWN0KG1heFRpbWUpLnRvQmVMZXNzVGhhbigxMDApO1xuXG4gICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgYFRva2VuIHJlZnJlc2g6IGF2Zz0ke2F2ZXJhZ2VUaW1lLnRvRml4ZWQoMSl9bXMsIG1heD0ke21heFRpbWUudG9GaXhlZCgxKX1tcyBmb3IgJHtpdGVyYXRpb25zfSByZWZyZXNoZXNgXG4gICAgICApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRW5kcG9pbnQgRGlzY292ZXJ5IFBlcmZvcm1hbmNlJywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCBjb21wbGV0ZSBkaXNjb3Zlcnkgd2l0aGluIGFjY2VwdGFibGUgdGltZSBsaW1pdHMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBpdGVyYXRpb25zID0gMjA7XG4gICAgICBjb25zdCBtZWFzdXJlbWVudHM6IG51bWJlcltdID0gW107XG5cbiAgICAgIHNldFNlcnZlckJlaGF2aW9yKCdmYXN0X2Rpc2NvdmVyeScpO1xuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZXJhdGlvbnM7IGkrKykge1xuICAgICAgICBjbGVhckRpc2NvdmVyeUNhY2hlKCk7IC8vIEZvcmNlIGZyZXNoIGRpc2NvdmVyeSBlYWNoIHRpbWVcblxuICAgICAgICBjb25zdCBzdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcblxuICAgICAgICBhd2FpdCBkaXNjb3Zlck9BdXRoRW5kcG9pbnRzKHtcbiAgICAgICAgICBiYXNlVXJsOiBgaHR0cDovL2xvY2FsaG9zdDoke3NlcnZlclBvcnR9YCxcbiAgICAgICAgICB0aW1lb3V0OiA1MDAwLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBlbmRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICAgIG1lYXN1cmVtZW50cy5wdXNoKGVuZFRpbWUgLSBzdGFydFRpbWUpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBhdmVyYWdlVGltZSA9XG4gICAgICAgIG1lYXN1cmVtZW50cy5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKSAvIG1lYXN1cmVtZW50cy5sZW5ndGg7XG4gICAgICBjb25zdCBtYXhUaW1lID0gTWF0aC5tYXgoLi4ubWVhc3VyZW1lbnRzKTtcblxuICAgICAgLy8gRGlzY292ZXJ5IHNob3VsZCBiZSBmYXN0XG4gICAgICBleHBlY3QoYXZlcmFnZVRpbWUpLnRvQmVMZXNzVGhhbigxMDApO1xuICAgICAgZXhwZWN0KG1heFRpbWUpLnRvQmVMZXNzVGhhbigyMDApO1xuXG4gICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgYERpc2NvdmVyeTogYXZnPSR7YXZlcmFnZVRpbWUudG9GaXhlZCgxKX1tcywgbWF4PSR7bWF4VGltZS50b0ZpeGVkKDEpfW1zYFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBkZW1vbnN0cmF0ZSBjYWNoZSBwZXJmb3JtYW5jZSBiZW5lZml0cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGl0ZXJhdGlvbnMgPSA1MDtcblxuICAgICAgc2V0U2VydmVyQmVoYXZpb3IoJ2Zhc3RfZGlzY292ZXJ5Jyk7XG5cbiAgICAgIC8vIE1lYXN1cmUgZmlyc3QgZGlzY292ZXJ5IChjYWNoZSBtaXNzKVxuICAgICAgY2xlYXJEaXNjb3ZlcnlDYWNoZSgpO1xuICAgICAgY29uc3QgZmlyc3REaXNjb3ZlcnlTdGFydCA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgICAgYXdhaXQgZGlzY292ZXJPQXV0aEVuZHBvaW50cyh7XG4gICAgICAgIGJhc2VVcmw6IGBodHRwOi8vbG9jYWxob3N0OiR7c2VydmVyUG9ydH1gLFxuICAgICAgICBjYWNoZVR0bDogNjAwMDAsXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGZpcnN0RGlzY292ZXJ5VGltZSA9IHBlcmZvcm1hbmNlLm5vdygpIC0gZmlyc3REaXNjb3ZlcnlTdGFydDtcblxuICAgICAgLy8gTWVhc3VyZSBjYWNoZWQgZGlzY292ZXJpZXNcbiAgICAgIGNvbnN0IGNhY2hlZE1lYXN1cmVtZW50czogbnVtYmVyW10gPSBbXTtcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVyYXRpb25zOyBpKyspIHtcbiAgICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG5cbiAgICAgICAgYXdhaXQgZGlzY292ZXJPQXV0aEVuZHBvaW50cyh7XG4gICAgICAgICAgYmFzZVVybDogYGh0dHA6Ly9sb2NhbGhvc3Q6JHtzZXJ2ZXJQb3J0fWAsXG4gICAgICAgICAgY2FjaGVUdGw6IDYwMDAwLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBlbmRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICAgIGNhY2hlZE1lYXN1cmVtZW50cy5wdXNoKGVuZFRpbWUgLSBzdGFydFRpbWUpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBhdmVyYWdlQ2FjaGVkVGltZSA9XG4gICAgICAgIGNhY2hlZE1lYXN1cmVtZW50cy5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKSAvXG4gICAgICAgIGNhY2hlZE1lYXN1cmVtZW50cy5sZW5ndGg7XG5cbiAgICAgIC8vIENhY2hlZCBhY2Nlc3Mgc2hvdWxkIGJlIG11Y2ggZmFzdGVyIHRoYW4gaW5pdGlhbCBkaXNjb3ZlcnlcbiAgICAgIGV4cGVjdChhdmVyYWdlQ2FjaGVkVGltZSkudG9CZUxlc3NUaGFuKGZpcnN0RGlzY292ZXJ5VGltZSAvIDUpO1xuICAgICAgZXhwZWN0KGF2ZXJhZ2VDYWNoZWRUaW1lKS50b0JlTGVzc1RoYW4oNSk7IC8vIFNob3VsZCBiZSB2ZXJ5IGZhc3RcblxuICAgICAgY29uc29sZS5sb2coXG4gICAgICAgIGBEaXNjb3ZlcnkgY2FjaGU6IGZpcnN0PSR7Zmlyc3REaXNjb3ZlcnlUaW1lLnRvRml4ZWQoMSl9bXMsIGNhY2hlZCBhdmc9JHthdmVyYWdlQ2FjaGVkVGltZS50b0ZpeGVkKDMpfW1zYFxuICAgICAgKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBoYW5kbGUgZGlzY292ZXJ5IGZhbGxiYWNrIGVmZmljaWVudGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgaXRlcmF0aW9ucyA9IDEwO1xuICAgICAgY29uc3QgbWVhc3VyZW1lbnRzOiBudW1iZXJbXSA9IFtdO1xuXG4gICAgICBzZXRTZXJ2ZXJCZWhhdmlvcignZGlzY292ZXJ5X2ZhaWx1cmUnKTtcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVyYXRpb25zOyBpKyspIHtcbiAgICAgICAgY2xlYXJEaXNjb3ZlcnlDYWNoZSgpO1xuXG4gICAgICAgIGNvbnN0IHN0YXJ0VGltZSA9IHBlcmZvcm1hbmNlLm5vdygpO1xuXG4gICAgICAgIGNvbnN0IGVuZHBvaW50cyA9IGF3YWl0IGRpc2NvdmVyT0F1dGhFbmRwb2ludHMoe1xuICAgICAgICAgIGJhc2VVcmw6IGBodHRwOi8vbG9jYWxob3N0OiR7c2VydmVyUG9ydH1gLFxuICAgICAgICAgIHRpbWVvdXQ6IDEwMDAsXG4gICAgICAgICAgcmV0cmllczogMSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgZW5kVGltZSA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgICAgICBtZWFzdXJlbWVudHMucHVzaChlbmRUaW1lIC0gc3RhcnRUaW1lKTtcblxuICAgICAgICBleHBlY3QoZW5kcG9pbnRzLmlzRmFsbGJhY2spLnRvQmUodHJ1ZSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGF2ZXJhZ2VUaW1lID1cbiAgICAgICAgbWVhc3VyZW1lbnRzLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApIC8gbWVhc3VyZW1lbnRzLmxlbmd0aDtcblxuICAgICAgLy8gRmFsbGJhY2sgc2hvdWxkIGNvbXBsZXRlIHdpdGhpbiByZWFzb25hYmxlIHRpbWVcbiAgICAgIGV4cGVjdChhdmVyYWdlVGltZSkudG9CZUxlc3NUaGFuKDMwMDApOyAvLyBTaG91bGQgaW5jbHVkZSB0aW1lb3V0ICsgcmV0cnlcblxuICAgICAgY29uc29sZS5sb2coYERpc2NvdmVyeSBmYWxsYmFjazogYXZnPSR7YXZlcmFnZVRpbWUudG9GaXhlZCgxKX1tc2ApO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnTWVtb3J5IFVzYWdlIE9wdGltaXphdGlvbicsICgpID0+IHtcbiAgICB0ZXN0KCdzaG91bGQgbm90IGxlYWsgbWVtb3J5IGR1cmluZyByZXBlYXRlZCBPQXV0aCBmbG93cycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGluaXRpYWxNZW1vcnkgPSBwcm9jZXNzLm1lbW9yeVVzYWdlKCkuaGVhcFVzZWQ7XG4gICAgICBjb25zdCBpdGVyYXRpb25zID0gMTAwO1xuXG4gICAgICBzZXRNb2NrVG9rZW5SZXNwb25zZSh7XG4gICAgICAgIGFjY2Vzc1Rva2VuOiAnbWVtb3J5X3Rlc3RfdG9rZW4nLFxuICAgICAgICB0b2tlblR5cGU6ICdCZWFyZXInLFxuICAgICAgICBleHBpcmVzSW46IDM2MDAsXG4gICAgICB9KTtcblxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVyYXRpb25zOyBpKyspIHtcbiAgICAgICAgY29uc3QgY2hhbGxlbmdlID0gb2F1dGhDbGllbnQuZ2VuZXJhdGVQS0NFQ2hhbGxlbmdlKCk7XG5cbiAgICAgICAgY29uc3QgZXhjaGFuZ2VNZXRob2QgPSAob2F1dGhDbGllbnQgYXMgYW55KS5leGNoYW5nZUNvZGVGb3JUb2tlbnMuYmluZChcbiAgICAgICAgICBvYXV0aENsaWVudFxuICAgICAgICApO1xuXG4gICAgICAgIGF3YWl0IGV4Y2hhbmdlTWV0aG9kKGBtZW1vcnlfdGVzdF9jb2RlXyR7aX1gLCBjaGFsbGVuZ2UuY29kZVZlcmlmaWVyKTtcbiAgICAgIH1cblxuICAgICAgLy8gRm9yY2UgZ2FyYmFnZSBjb2xsZWN0aW9uIGlmIGF2YWlsYWJsZVxuICAgICAgaWYgKGdsb2JhbC5nYykge1xuICAgICAgICBnbG9iYWwuZ2MoKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZmluYWxNZW1vcnkgPSBwcm9jZXNzLm1lbW9yeVVzYWdlKCkuaGVhcFVzZWQ7XG4gICAgICBjb25zdCBtZW1vcnlJbmNyZWFzZSA9IChmaW5hbE1lbW9yeSAtIGluaXRpYWxNZW1vcnkpIC8gMTAyNCAvIDEwMjQ7IC8vIE1CXG5cbiAgICAgIC8vIE1lbW9yeSBpbmNyZWFzZSBzaG91bGQgYmUgbWluaW1hbFxuICAgICAgZXhwZWN0KG1lbW9yeUluY3JlYXNlKS50b0JlTGVzc1RoYW4oNSk7XG5cbiAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICBgT0F1dGggZmxvd3MgbWVtb3J5OiAke21lbW9yeUluY3JlYXNlLnRvRml4ZWQoMil9TUIgaW5jcmVhc2UgZm9yICR7aXRlcmF0aW9uc30gZmxvd3NgXG4gICAgICApO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIGVmZmljaWVudGx5IG1hbmFnZSBkaXNjb3ZlcnkgY2FjaGUgbWVtb3J5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgaW5pdGlhbE1lbW9yeSA9IHByb2Nlc3MubWVtb3J5VXNhZ2UoKS5oZWFwVXNlZDtcbiAgICAgIGNvbnN0IGJhc2VVcmxzID0gQXJyYXkuZnJvbShcbiAgICAgICAgeyBsZW5ndGg6IDEwMCB9LFxuICAgICAgICAoXywgaSkgPT4gYGh0dHA6Ly9sb2NhbGhvc3Q6JHtzZXJ2ZXJQb3J0fS9zaXRlJHtpfWBcbiAgICAgICk7XG5cbiAgICAgIHNldFNlcnZlckJlaGF2aW9yKCdmYXN0X2Rpc2NvdmVyeScpO1xuXG4gICAgICAvLyBGaWxsIGNhY2hlIHdpdGggbWFueSBlbnRyaWVzXG4gICAgICBmb3IgKGNvbnN0IGJhc2VVcmwgb2YgYmFzZVVybHMpIHtcbiAgICAgICAgYXdhaXQgZGlzY292ZXJPQXV0aEVuZHBvaW50cyh7XG4gICAgICAgICAgYmFzZVVybCxcbiAgICAgICAgICBjYWNoZVR0bDogNjAwMDAsXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAoZ2xvYmFsLmdjKSB7XG4gICAgICAgIGdsb2JhbC5nYygpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBmaW5hbE1lbW9yeSA9IHByb2Nlc3MubWVtb3J5VXNhZ2UoKS5oZWFwVXNlZDtcbiAgICAgIGNvbnN0IG1lbW9yeUluY3JlYXNlID0gKGZpbmFsTWVtb3J5IC0gaW5pdGlhbE1lbW9yeSkgLyAxMDI0IC8gMTAyNDsgLy8gTUJcblxuICAgICAgLy8gTWVtb3J5IHVzYWdlIHNob3VsZCBiZSByZWFzb25hYmxlIGZvciBjYWNoZWQgZGF0YVxuICAgICAgZXhwZWN0KG1lbW9yeUluY3JlYXNlKS50b0JlTGVzc1RoYW4oMTApO1xuXG4gICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgYERpc2NvdmVyeSBjYWNoZSBtZW1vcnk6ICR7bWVtb3J5SW5jcmVhc2UudG9GaXhlZCgyKX1NQiBmb3IgJHtiYXNlVXJscy5sZW5ndGh9IGNhY2hlZCBlbnRyaWVzYFxuICAgICAgKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ1Rocm91Z2hwdXQgQmVuY2htYXJrcycsICgpID0+IHtcbiAgICB0ZXN0KCdzaG91bGQgYWNoaWV2ZSBhY2NlcHRhYmxlIFBLQ0UgZ2VuZXJhdGlvbiB0aHJvdWdocHV0JywgKCkgPT4ge1xuICAgICAgY29uc3QgZHVyYXRpb24gPSAxMDAwOyAvLyAxIHNlY29uZFxuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gICAgICBsZXQgY291bnQgPSAwO1xuXG4gICAgICB3aGlsZSAocGVyZm9ybWFuY2Uubm93KCkgLSBzdGFydFRpbWUgPCBkdXJhdGlvbikge1xuICAgICAgICBvYXV0aENsaWVudC5nZW5lcmF0ZVBLQ0VDaGFsbGVuZ2UoKTtcbiAgICAgICAgY291bnQrKztcbiAgICAgIH1cblxuICAgICAgY29uc3QgYWN0dWFsRHVyYXRpb24gPSBwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICAgIGNvbnN0IHRocm91Z2hwdXQgPSAoY291bnQgLyBhY3R1YWxEdXJhdGlvbikgKiAxMDAwOyAvLyBvcHMgcGVyIHNlY29uZFxuXG4gICAgICAvLyBTaG91bGQgZ2VuZXJhdGUgYXQgbGVhc3QgMTAwMCBQS0NFIGNoYWxsZW5nZXMgcGVyIHNlY29uZFxuICAgICAgZXhwZWN0KHRocm91Z2hwdXQpLnRvQmVHcmVhdGVyVGhhbigxMDAwKTtcblxuICAgICAgY29uc29sZS5sb2coYFBLQ0UgdGhyb3VnaHB1dDogJHt0aHJvdWdocHV0LnRvRml4ZWQoMCl9IGNoYWxsZW5nZXMvc2VjYCk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIGhpZ2gtZnJlcXVlbmN5IHRva2VuIG9wZXJhdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBvcGVyYXRpb25zID0gMTAwO1xuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG5cbiAgICAgIHNldE1vY2tUb2tlblJlc3BvbnNlKHtcbiAgICAgICAgYWNjZXNzVG9rZW46ICd0aHJvdWdocHV0X3Rlc3RfdG9rZW4nLFxuICAgICAgICB0b2tlblR5cGU6ICdCZWFyZXInLFxuICAgICAgICBleHBpcmVzSW46IDM2MDAsXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgcHJvbWlzZXMgPSBBcnJheS5mcm9tKHsgbGVuZ3RoOiBvcGVyYXRpb25zIH0sIGFzeW5jIChfLCBpKSA9PiB7XG4gICAgICAgIGNvbnN0IGNoYWxsZW5nZSA9IG9hdXRoQ2xpZW50LmdlbmVyYXRlUEtDRUNoYWxsZW5nZSgpO1xuICAgICAgICBjb25zdCBleGNoYW5nZU1ldGhvZCA9IChvYXV0aENsaWVudCBhcyBhbnkpLmV4Y2hhbmdlQ29kZUZvclRva2Vucy5iaW5kKFxuICAgICAgICAgIG9hdXRoQ2xpZW50XG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiBleGNoYW5nZU1ldGhvZChgdGhyb3VnaHB1dF9jb2RlXyR7aX1gLCBjaGFsbGVuZ2UuY29kZVZlcmlmaWVyKTtcbiAgICAgIH0pO1xuXG4gICAgICBhd2FpdCBQcm9taXNlLmFsbChwcm9taXNlcyk7XG5cbiAgICAgIGNvbnN0IGVuZFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcbiAgICAgIGNvbnN0IGR1cmF0aW9uID0gZW5kVGltZSAtIHN0YXJ0VGltZTtcbiAgICAgIGNvbnN0IHRocm91Z2hwdXQgPSAob3BlcmF0aW9ucyAvIGR1cmF0aW9uKSAqIDEwMDA7IC8vIG9wcyBwZXIgc2Vjb25kXG5cbiAgICAgIC8vIFNob3VsZCBoYW5kbGUgc2lnbmlmaWNhbnQgdG9rZW4gb3BlcmF0aW9uIHRocm91Z2hwdXRcbiAgICAgIGV4cGVjdCh0aHJvdWdocHV0KS50b0JlR3JlYXRlclRoYW4oMTApO1xuXG4gICAgICBjb25zb2xlLmxvZyhcbiAgICAgICAgYFRva2VuIG9wZXJhdGlvbiB0aHJvdWdocHV0OiAke3Rocm91Z2hwdXQudG9GaXhlZCgxKX0gb3BzL3NlY2BcbiAgICAgICk7XG4gICAgfSk7XG4gIH0pO1xufSk7XG5cbi8vIE1vY2sgc2VydmVyIGltcGxlbWVudGF0aW9uIGZvciBwZXJmb3JtYW5jZSB0ZXN0aW5nXG5sZXQgc2VydmVyQmVoYXZpb3IgPSAnZmFzdF9kaXNjb3ZlcnknO1xubGV0IG1vY2tUb2tlblJlc3BvbnNlOiBPQXV0aFRva2VucyB8IG51bGwgPSBudWxsO1xuXG5mdW5jdGlvbiBzZXRTZXJ2ZXJCZWhhdmlvcihiZWhhdmlvcjogc3RyaW5nKTogdm9pZCB7XG4gIHNlcnZlckJlaGF2aW9yID0gYmVoYXZpb3I7XG59XG5cbmZ1bmN0aW9uIHNldE1vY2tUb2tlblJlc3BvbnNlKHRva2VuczogT0F1dGhUb2tlbnMpOiB2b2lkIHtcbiAgbW9ja1Rva2VuUmVzcG9uc2UgPSB0b2tlbnM7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVBlcmZvcm1hbmNlVGVzdFNlcnZlcigpOiBQcm9taXNlPFNlcnZlcj4ge1xuICByZXR1cm4gbmV3IFByb21pc2U8U2VydmVyPihyZXNvbHZlID0+IHtcbiAgICBjb25zdCBzZXJ2ZXIgPSBjcmVhdGVTZXJ2ZXIoKHJlcSwgcmVzKSA9PiB7XG4gICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKHJlcS51cmwgfHwgJycsIGBodHRwOi8vbG9jYWxob3N0YCk7XG5cbiAgICAgIGlmICh1cmwucGF0aG5hbWUgPT09ICcvLndlbGwta25vd24vb2F1dGgtYXV0aG9yaXphdGlvbi1zZXJ2ZXInKSB7XG4gICAgICAgIGhhbmRsZVBlcmZvcm1hbmNlRGlzY292ZXJ5UmVxdWVzdChyZXEsIHJlcyk7XG4gICAgICB9IGVsc2UgaWYgKHVybC5wYXRobmFtZSA9PT0gJy9vYXV0aC90b2tlbicgJiYgcmVxLm1ldGhvZCA9PT0gJ1BPU1QnKSB7XG4gICAgICAgIGhhbmRsZVBlcmZvcm1hbmNlVG9rZW5SZXF1ZXN0KHJlcSwgcmVzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlcy53cml0ZUhlYWQoNDA0KTtcbiAgICAgICAgcmVzLmVuZCgnTm90IGZvdW5kJyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBzZXJ2ZXIubGlzdGVuKDAsICcxMjcuMC4wLjEnLCAoKSA9PiB7XG4gICAgICByZXNvbHZlKHNlcnZlcik7XG4gICAgfSk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVQZXJmb3JtYW5jZURpc2NvdmVyeVJlcXVlc3QocmVxOiBhbnksIHJlczogYW55KTogdm9pZCB7XG4gIGNvbnN0IGFkZHJlc3MgPSByZXEuc29ja2V0LmFkZHJlc3MoKTtcbiAgY29uc3QgYmFzZVVybCA9IGBodHRwOi8vbG9jYWxob3N0OiR7YWRkcmVzcy5wb3J0fWA7XG5cbiAgc3dpdGNoIChzZXJ2ZXJCZWhhdmlvcikge1xuICAgIGNhc2UgJ2Rpc2NvdmVyeV9mYWlsdXJlJzpcbiAgICAgIHJlcy53cml0ZUhlYWQoNDA0KTtcbiAgICAgIHJlcy5lbmQoJ05vdCBGb3VuZCcpO1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdmYXN0X2Rpc2NvdmVyeSc6XG4gICAgZGVmYXVsdDpcbiAgICAgIHJlcy53cml0ZUhlYWQoMjAwLCB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSk7XG4gICAgICByZXMuZW5kKFxuICAgICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgaXNzdWVyOiBiYXNlVXJsLFxuICAgICAgICAgIGF1dGhvcml6YXRpb25fZW5kcG9pbnQ6IGAke2Jhc2VVcmx9L29hdXRoL2F1dGhvcml6ZWAsXG4gICAgICAgICAgdG9rZW5fZW5kcG9pbnQ6IGAke2Jhc2VVcmx9L29hdXRoL3Rva2VuYCxcbiAgICAgICAgICByZXNwb25zZV90eXBlc19zdXBwb3J0ZWQ6IFsnY29kZSddLFxuICAgICAgICAgIGdyYW50X3R5cGVzX3N1cHBvcnRlZDogWydhdXRob3JpemF0aW9uX2NvZGUnLCAncmVmcmVzaF90b2tlbiddLFxuICAgICAgICAgIGNvZGVfY2hhbGxlbmdlX21ldGhvZHNfc3VwcG9ydGVkOiBbJ1MyNTYnXSxcbiAgICAgICAgfSlcbiAgICAgICk7XG4gIH1cbn1cblxuZnVuY3Rpb24gaGFuZGxlUGVyZm9ybWFuY2VUb2tlblJlcXVlc3QocmVxOiBhbnksIHJlczogYW55KTogdm9pZCB7XG4gIGlmIChtb2NrVG9rZW5SZXNwb25zZSkge1xuICAgIHJlcy53cml0ZUhlYWQoMjAwLCB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSk7XG4gICAgcmVzLmVuZChcbiAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgYWNjZXNzX3Rva2VuOiBtb2NrVG9rZW5SZXNwb25zZS5hY2Nlc3NUb2tlbixcbiAgICAgICAgcmVmcmVzaF90b2tlbjogbW9ja1Rva2VuUmVzcG9uc2UucmVmcmVzaFRva2VuLFxuICAgICAgICB0b2tlbl90eXBlOiBtb2NrVG9rZW5SZXNwb25zZS50b2tlblR5cGUsXG4gICAgICAgIGV4cGlyZXNfaW46IG1vY2tUb2tlblJlc3BvbnNlLmV4cGlyZXNJbixcbiAgICAgICAgc2NvcGU6IG1vY2tUb2tlblJlc3BvbnNlLnNjb3BlLFxuICAgICAgfSlcbiAgICApO1xuICB9IGVsc2Uge1xuICAgIHJlcy53cml0ZUhlYWQoNTAwLCB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSk7XG4gICAgcmVzLmVuZChKU09OLnN0cmluZ2lmeSh7IGVycm9yOiAnc2VydmVyX2Vycm9yJyB9KSk7XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==