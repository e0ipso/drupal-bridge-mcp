{"file":"/workspace/src/auth/types.ts","mappings":";AAAA;;GAEG;;;AAkGH;;GAEG;AACH,IAAY,kBAOX;AAPD,WAAY,kBAAkB;IAC5B,qDAA+B,CAAA;IAC/B,qDAA+B,CAAA;IAC/B,mDAA6B,CAAA;IAC7B,yEAAmD,CAAA;IACnD,uDAAiC,CAAA;IACjC,iDAA2B,CAAA;AAC7B,CAAC,EAPW,kBAAkB,kCAAlB,kBAAkB,QAO7B;AAED;;GAEG;AACH,MAAa,cAAe,SAAQ,KAAK;IACvB,IAAI,CAAqB;IAChB,KAAK,CAAS;IAEvC,YAAY,OAAe,EAAE,IAAwB,EAAE,KAAa;QAClE,KAAK,CAAC,OAAO,CAAC,CAAC;QACf,IAAI,CAAC,IAAI,GAAG,gBAAgB,CAAC;QAC7B,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACjB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;IACrB,CAAC;CACF;AAVD,wCAUC","names":[],"sources":["/workspace/src/auth/types.ts"],"sourcesContent":["/**\n * TypeScript interfaces for OAuth 2.1 endpoint discovery and metadata\n */\n\n/**\n * OAuth 2.0 Authorization Server Metadata as defined by RFC8414\n * https://tools.ietf.org/html/rfc8414#section-2\n */\nexport interface OAuthServerMetadata {\n  /** The authorization server's issuer identifier */\n  issuer: string;\n\n  /** URL of the authorization server's authorization endpoint */\n  authorization_endpoint: string;\n\n  /** URL of the authorization server's token endpoint */\n  token_endpoint: string;\n\n  /** URL of the authorization server's JWK Set document */\n  jwks_uri?: string;\n\n  /** JSON array containing a list of OAuth 2.0 scope values supported */\n  scopes_supported?: string[];\n\n  /** JSON array containing a list of PKCE code challenge methods supported */\n  code_challenge_methods_supported?: string[];\n\n  /** JSON array containing a list of response types supported */\n  response_types_supported?: string[];\n\n  /** JSON array containing a list of grant types supported */\n  grant_types_supported?: string[];\n\n  /** JSON array containing a list of token endpoint authentication methods */\n  token_endpoint_auth_methods_supported?: string[];\n\n  /** URL of the authorization server's revocation endpoint */\n  revocation_endpoint?: string;\n\n  /** URL of the authorization server's introspection endpoint */\n  introspection_endpoint?: string;\n}\n\n/**\n * Resolved OAuth endpoints for client use\n */\nexport interface OAuthEndpoints {\n  /** The authorization endpoint URL */\n  authorizationEndpoint: string;\n\n  /** The token endpoint URL */\n  tokenEndpoint: string;\n\n  /** The issuer identifier */\n  issuer: string;\n\n  /** When the endpoints were discovered */\n  discoveredAt: Date;\n\n  /** Whether fallback endpoints were used due to discovery failure */\n  isFallback?: boolean;\n\n  /** Additional metadata from discovery (optional) */\n  metadata?: Partial<OAuthServerMetadata>;\n}\n\n/**\n * Configuration options for endpoint discovery\n */\nexport interface DiscoveryConfig {\n  /** Base URL of the OAuth authorization server */\n  baseUrl: string;\n\n  /** Timeout for discovery requests in milliseconds (default: 5000) */\n  timeout?: number;\n\n  /** Number of retry attempts for failed requests (default: 2) */\n  retries?: number;\n\n  /** TTL for cached metadata in milliseconds (default: 3600000 = 1 hour) */\n  cacheTtl?: number;\n\n  /** Whether to validate HTTPS in production (default: true) */\n  validateHttps?: boolean;\n\n  /** Whether to enable debug logging (default: false) */\n  debug?: boolean;\n}\n\n/**\n * Cache entry for discovered metadata\n */\nexport interface CacheEntry {\n  /** The cached OAuth endpoints */\n  endpoints: OAuthEndpoints;\n\n  /** Expiration timestamp */\n  expiresAt: number;\n}\n\n/**\n * Discovery error types\n */\nexport enum DiscoveryErrorType {\n  NETWORK_ERROR = 'NETWORK_ERROR',\n  TIMEOUT_ERROR = 'TIMEOUT_ERROR',\n  INVALID_JSON = 'INVALID_JSON',\n  MISSING_REQUIRED_FIELDS = 'MISSING_REQUIRED_FIELDS',\n  HTTPS_REQUIRED = 'HTTPS_REQUIRED',\n  INVALID_URL = 'INVALID_URL',\n}\n\n/**\n * Discovery error class\n */\nexport class DiscoveryError extends Error {\n  public readonly type: DiscoveryErrorType;\n  public override readonly cause?: Error;\n\n  constructor(message: string, type: DiscoveryErrorType, cause?: Error) {\n    super(message);\n    this.name = 'DiscoveryError';\n    this.type = type;\n    this.cause = cause;\n  }\n}\n"],"version":3}