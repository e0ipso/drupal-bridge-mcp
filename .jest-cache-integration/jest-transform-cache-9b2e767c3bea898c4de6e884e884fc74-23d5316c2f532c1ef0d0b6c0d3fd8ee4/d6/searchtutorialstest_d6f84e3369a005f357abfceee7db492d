aca7480e8fedbadbb154d6119c785db6
"use strict";
/**
 * Tests for search_tutorials MCP tool functionality
 */
Object.defineProperty(exports, "__esModule", { value: true });
const server_js_1 = require("@/mcp/server.js");
const validation_js_1 = require("@/utils/validation.js");
// Mock configuration for testing
const mockConfig = {
    drupal: {
        baseUrl: 'http://localhost/drupal',
        endpoint: '/jsonrpc',
        timeout: 10000,
        retries: 3,
        headers: {
            'Content-Type': 'application/json',
            Accept: 'application/json',
        },
    },
    mcp: {
        name: 'test-mcp-server',
        version: '1.0.0',
        protocolVersion: '2024-11-05',
        capabilities: {
            tools: { listChanged: true },
            resources: { subscribe: true, listChanged: true },
            prompts: { listChanged: true },
        },
    },
    oauth: {
        clientId: 'test-client-id',
        authorizationEndpoint: 'http://localhost/oauth/authorize',
        tokenEndpoint: 'http://localhost/oauth/token',
        redirectUri: 'http://localhost/callback',
        scopes: ['read'],
    },
    auth: {
        enabled: false, // Disable auth for tests
        requiredScopes: ['read'],
        skipAuth: true,
    },
    server: {
        port: 3000,
        host: 'localhost',
    },
    logging: {
        level: 'info',
    },
    environment: 'test',
};
describe('Search Tutorials MCP Tool', () => {
    let mcpServer;
    beforeEach(() => {
        mcpServer = new server_js_1.DrupalMcpServer(mockConfig);
    });
    afterEach(async () => {
        await mcpServer.close();
    });
    describe('Parameter Validation', () => {
        describe('validateSearchContentParams', () => {
            it('should validate valid parameters successfully', () => {
                const validParams = {
                    keywords: 'drupal configuration',
                    types: ['tutorial', 'topic'],
                    drupal_version: ['10', '11'],
                    category: ['configuration', 'settings'],
                    sort: 'search_api_relevance',
                    page: { limit: 10, offset: 0 },
                };
                const result = (0, validation_js_1.validateSearchContentParams)(validParams);
                expect(result).toEqual({
                    keywords: 'drupal configuration',
                    types: ['tutorial', 'topic'],
                    drupal_version: ['10', '11'],
                    category: ['configuration', 'settings'],
                    sort: 'search_api_relevance',
                    page: { limit: 10, offset: 0 },
                });
            });
            it('should validate minimal parameters (keywords only)', () => {
                const minimalParams = { keywords: 'test' };
                const result = (0, validation_js_1.validateSearchContentParams)(minimalParams);
                expect(result).toEqual({
                    keywords: 'test',
                    types: ['tutorial', 'topic', 'course'], // default values
                    drupal_version: undefined,
                    category: undefined,
                    sort: 'search_api_relevance',
                    page: { limit: 10, offset: 0 },
                });
            });
            it('should throw ValidationError for missing keywords', () => {
                expect(() => (0, validation_js_1.validateSearchContentParams)({})).toThrow(validation_js_1.ValidationError);
                expect(() => (0, validation_js_1.validateSearchContentParams)({ keywords: '' })).toThrow(validation_js_1.ValidationError);
            });
            it('should throw ValidationError for invalid keywords type', () => {
                expect(() => (0, validation_js_1.validateSearchContentParams)({ keywords: 123 })).toThrow(validation_js_1.ValidationError);
                expect(() => (0, validation_js_1.validateSearchContentParams)({ keywords: null })).toThrow(validation_js_1.ValidationError);
            });
            it('should throw ValidationError for keywords too short', () => {
                expect(() => (0, validation_js_1.validateSearchContentParams)({ keywords: 'a' })).toThrow(validation_js_1.ValidationError);
            });
            it('should throw ValidationError for invalid types array items', () => {
                expect(() => (0, validation_js_1.validateSearchContentParams)({
                    keywords: 'test',
                    types: ['invalid-type'],
                })).toThrow(validation_js_1.ValidationError);
            });
            it('should throw ValidationError for invalid drupal_version array items', () => {
                expect(() => (0, validation_js_1.validateSearchContentParams)({
                    keywords: 'test',
                    drupal_version: ['8'], // Invalid version
                })).toThrow(validation_js_1.ValidationError);
            });
            it('should validate drupal_version as array', () => {
                const params = {
                    keywords: 'test',
                    drupal_version: ['9', '10', '11'],
                };
                const result = (0, validation_js_1.validateSearchContentParams)(params);
                expect(result.drupal_version).toEqual(['9', '10', '11']);
            });
            it('should filter and normalize category tags', () => {
                const params = {
                    keywords: 'test',
                    category: ['Config', 'SETTINGS', 'config', '  spaces  ', 'valid-tag'],
                };
                const result = (0, validation_js_1.validateSearchContentParams)(params);
                expect(result.category).toEqual([
                    'config',
                    'settings',
                    'spaces',
                    'valid-tag',
                ]);
            });
            it('should validate page object structure', () => {
                const params = {
                    keywords: 'test',
                    page: { limit: 20, offset: 10 },
                };
                const result = (0, validation_js_1.validateSearchContentParams)(params);
                expect(result.page).toEqual({ limit: 20, offset: 10 });
            });
            it('should throw ValidationError for invalid page limit', () => {
                expect(() => (0, validation_js_1.validateSearchContentParams)({
                    keywords: 'test',
                    page: { limit: 101, offset: 0 }, // Exceeds max limit
                })).toThrow(validation_js_1.ValidationError);
            });
            it('should throw ValidationError for invalid page offset', () => {
                expect(() => (0, validation_js_1.validateSearchContentParams)({
                    keywords: 'test',
                    page: { limit: 10, offset: -1 }, // Negative offset
                })).toThrow(validation_js_1.ValidationError);
            });
            it('should trim and normalize keywords', () => {
                const params = { keywords: '  drupal configuration  ' };
                const result = (0, validation_js_1.validateSearchContentParams)(params);
                expect(result.keywords).toBe('drupal configuration');
            });
        });
    });
    describe('Tool Registration', () => {
        it('should register search_tutorials tool in tools list', () => {
            const server = mcpServer.getServer();
            const tools = mcpServer.getTools();
            const searchTutorialsTool = tools.find((tool) => tool.name === 'search_tutorials');
            expect(searchTutorialsTool).toBeDefined();
            expect(searchTutorialsTool.description).toContain('Search Drupalize.me tutorials');
        });
        it('should have correct tool schema for new parameters', () => {
            const tools = mcpServer.getTools();
            const searchTutorialsTool = tools.find((tool) => tool.name === 'search_tutorials');
            expect(searchTutorialsTool.inputSchema).toEqual({
                type: 'object',
                properties: {
                    keywords: {
                        type: 'string',
                        description: 'Search keywords (minimum 2 characters)',
                        minLength: 2,
                    },
                    types: {
                        type: 'array',
                        description: 'Filter by content types (defaults to ["tutorial", "topic", "course"])',
                        items: {
                            type: 'string',
                            enum: ['tutorial', 'topic', 'course', 'video', 'guide'],
                        },
                    },
                    drupal_version: {
                        type: 'array',
                        description: 'Filter by Drupal versions',
                        items: {
                            type: 'string',
                            enum: ['9', '10', '11'],
                        },
                    },
                    category: {
                        type: 'array',
                        description: 'Filter by tutorial categories/tags',
                        items: {
                            type: 'string',
                        },
                    },
                    sort: {
                        type: 'string',
                        description: 'Sort results by relevance, date, or title',
                        enum: ['search_api_relevance', 'created', 'changed', 'title'],
                    },
                    page: {
                        type: 'object',
                        description: 'Pagination settings',
                        properties: {
                            limit: {
                                type: 'number',
                                description: 'Number of results per page',
                                minimum: 1,
                                maximum: 100,
                                default: 10,
                            },
                            offset: {
                                type: 'number',
                                description: 'Number of results to skip',
                                minimum: 0,
                                default: 0,
                            },
                        },
                    },
                },
                required: ['keywords'],
            });
        });
    });
    describe('Tool Execution', () => {
        it('should execute search_tutorials tool successfully with new format', async () => {
            const params = {
                keywords: 'drupal configuration',
                types: ['tutorial', 'topic'],
                drupal_version: ['10'],
                category: ['config', 'settings'],
                sort: 'search_api_relevance',
                page: { limit: 10, offset: 0 },
            };
            const result = await mcpServer.executeSearchTutorials(params);
            expect(result).toEqual({
                results: expect.arrayContaining([
                    expect.objectContaining({
                        id: expect.any(String),
                        title: expect.stringContaining('drupal configuration'),
                        url: expect.stringMatching(/^https?:\/\//),
                        drupal_version: expect.arrayContaining(['10']),
                        tags: expect.arrayContaining(['config', 'settings']),
                    }),
                ]),
                total: expect.any(Number),
                facets: expect.any(Object),
                query: {
                    keywords: 'drupal configuration',
                    types: ['tutorial', 'topic'],
                    drupal_version: ['10'],
                    category: ['config', 'settings'],
                    sort: 'search_api_relevance',
                    page: { limit: 10, offset: 0 },
                },
            });
        });
        it('should handle search with minimal parameters', async () => {
            const params = { keywords: 'drupal theming' };
            const result = await mcpServer.executeSearchTutorials(params);
            expect(result.query.drupal_version).toBeUndefined();
            expect(result.query.types).toEqual(['tutorial', 'topic', 'course']);
            expect(result.results[0].drupal_version).toEqual(['10', '11']);
        });
        it('should handle search without categories', async () => {
            const params = { keywords: 'drupal api' };
            const result = await mcpServer.executeSearchTutorials(params);
            expect(result.query.category).toBeUndefined();
            expect(result.results[0].tags).toEqual(['tutorial', 'drupal']);
        });
        it('should filter results by drupal_version array', async () => {
            const params = {
                keywords: 'drupal api',
                drupal_version: ['9'],
            };
            const result = await mcpServer.executeSearchTutorials(params);
            // Should return results filtered for Drupal 9
            expect(result.results).toHaveLength(1);
            expect(result.total).toBe(1);
            expect(result.results[0].drupal_version).toContain('9');
            expect(result.results[0].title).toContain('Drupal 9 specific');
        });
        it('should use new RPC method dme_mcp.search_content', async () => {
            // Since we're in test environment, this will use mock data
            // The test validates that the parameters are processed correctly
            const params = {
                keywords: 'test drupal configuration',
                types: ['tutorial'],
                drupal_version: ['10'],
                page: { limit: 5, offset: 0 },
            };
            const result = await mcpServer.executeSearchTutorials(params);
            // Verify the result has the expected structure for new format
            expect(result).toHaveProperty('results');
            expect(result).toHaveProperty('total');
            expect(result).toHaveProperty('facets'); // New facets object
            expect(result).toHaveProperty('query');
            // Verify that query reflects the processed parameters
            expect(result.query).toEqual({
                keywords: 'test drupal configuration',
                types: ['tutorial'],
                drupal_version: ['10'],
                category: undefined,
                sort: 'search_api_relevance',
                page: { limit: 5, offset: 0 },
            });
        });
    });
    describe('Error Handling', () => {
        it('should handle validation errors gracefully through executeTool', async () => {
            const invalidParams = { keywords: 'x' }; // Too short
            const result = await mcpServer.executeTool('search_tutorials', invalidParams);
            const errorResponse = JSON.parse(result.content[0].text);
            expect(errorResponse.error.type).toBe('VALIDATION_ERROR');
            expect(errorResponse.error.message).toContain('keywords');
        });
        it('should handle missing parameters through executeTool', async () => {
            const result = await mcpServer.executeTool('search_tutorials', {});
            const errorResponse = JSON.parse(result.content[0].text);
            expect(errorResponse.error.type).toBe('VALIDATION_ERROR');
            expect(errorResponse.error.message).toContain('keywords');
        });
        it('should handle invalid argument types through executeTool', async () => {
            const result = await mcpServer.executeTool('search_tutorials', 'invalid');
            const errorResponse = JSON.parse(result.content[0].text);
            expect(errorResponse.error.type).toBe('VALIDATION_ERROR');
            expect(errorResponse.error.message).toContain('Invalid arguments');
        });
        it('should handle invalid types parameter', async () => {
            const invalidParams = {
                keywords: 'test',
                types: ['invalid-type'],
            };
            const result = await mcpServer.executeTool('search_tutorials', invalidParams);
            const errorResponse = JSON.parse(result.content[0].text);
            expect(errorResponse.error.type).toBe('VALIDATION_ERROR');
            expect(errorResponse.error.message).toContain('types');
        });
        it('should handle invalid drupal_version array', async () => {
            const invalidParams = {
                keywords: 'test',
                drupal_version: ['8'], // Invalid version
            };
            const result = await mcpServer.executeTool('search_tutorials', invalidParams);
            const errorResponse = JSON.parse(result.content[0].text);
            expect(errorResponse.error.type).toBe('VALIDATION_ERROR');
            expect(errorResponse.error.message).toContain('drupal_version');
        });
    });
    describe('Response Format', () => {
        it('should return response in correct MCP tool format', async () => {
            const params = { keywords: 'drupal basics' };
            const result = await mcpServer.executeTool('search_tutorials', params);
            expect(result).toHaveProperty('content');
            expect(result.content).toHaveLength(1);
            expect(result.content[0]).toHaveProperty('type', 'text');
            expect(result.content[0]).toHaveProperty('text');
            // Parse the JSON response
            const responseData = JSON.parse(result.content[0].text);
            expect(responseData).toHaveProperty('results');
            expect(responseData).toHaveProperty('total');
            expect(responseData).toHaveProperty('facets'); // New facets object
            expect(responseData).toHaveProperty('query');
        });
        it('should return structured tutorial data with new format', async () => {
            const params = { keywords: 'drupal modules' };
            const result = await mcpServer.executeSearchTutorials(params);
            const tutorial = result.results[0];
            expect(tutorial).toHaveProperty('id');
            expect(tutorial).toHaveProperty('title');
            expect(tutorial).toHaveProperty('url');
            expect(tutorial).toHaveProperty('description');
            expect(tutorial).toHaveProperty('drupal_version');
            expect(tutorial).toHaveProperty('tags');
            expect(tutorial).toHaveProperty('difficulty');
            expect(tutorial).toHaveProperty('created');
            expect(tutorial).toHaveProperty('updated');
            // Validate required fields
            expect(tutorial.id).toBeTruthy();
            expect(tutorial.title).toBeTruthy();
            expect(tutorial.url).toMatch(/^https?:\/\//);
            expect(tutorial.created).toMatch(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/);
        });
        it('should include facets in response', async () => {
            const params = { keywords: 'drupal configuration' };
            const result = await mcpServer.executeSearchTutorials(params);
            expect(result).toHaveProperty('facets');
            expect(result.facets).toBeDefined();
            expect(typeof result.facets).toBe('object');
        });
        it('should include query object with new parameter structure', async () => {
            const params = {
                keywords: 'drupal testing',
                types: ['tutorial'],
                drupal_version: ['10', '11'],
                sort: 'created',
            };
            const result = await mcpServer.executeSearchTutorials(params);
            expect(result.query).toEqual({
                keywords: 'drupal testing',
                types: ['tutorial'],
                drupal_version: ['10', '11'],
                category: undefined,
                sort: 'created',
                page: { limit: 10, offset: 0 },
            });
        });
    });
});
describe('Integration with MCP Server', () => {
    let mcpServer;
    beforeEach(() => {
        mcpServer = new server_js_1.DrupalMcpServer(mockConfig);
    });
    afterEach(async () => {
        await mcpServer.close();
    });
    it('should be available in tools list', () => {
        const tools = mcpServer.getTools();
        const toolNames = tools.map((tool) => tool.name);
        expect(toolNames).toContain('search_tutorials');
    });
    it('should execute through the standard tool execution flow with new format', async () => {
        const result = await mcpServer.executeTool('search_tutorials', {
            keywords: 'drupal testing',
            drupal_version: ['11'],
        });
        expect(result.content[0].type).toBe('text');
        const responseData = JSON.parse(result.content[0].text);
        expect(responseData.query.keywords).toBe('drupal testing');
        expect(responseData.query.drupal_version).toEqual(['11']);
        expect(responseData).toHaveProperty('facets'); // New facets object
    });
    it('should validate complete search workflow with new parameters', async () => {
        const searchParams = {
            keywords: 'drupal configuration management',
            types: ['tutorial', 'guide'],
            drupal_version: ['10', '11'],
            category: ['config', 'admin'],
            sort: 'search_api_relevance',
            page: { limit: 20, offset: 10 },
        };
        const result = await mcpServer.executeTool('search_tutorials', searchParams);
        expect(result.content[0].type).toBe('text');
        const responseData = JSON.parse(result.content[0].text);
        // Validate complete parameter transformation
        expect(responseData.query).toMatchObject({
            keywords: 'drupal configuration management',
            types: ['tutorial', 'guide'],
            drupal_version: ['10', '11'],
            category: ['config', 'admin'],
            sort: 'search_api_relevance',
            page: { limit: 20, offset: 10 },
        });
        // Validate response structure
        expect(responseData).toHaveProperty('results');
        expect(responseData).toHaveProperty('total');
        expect(responseData).toHaveProperty('facets');
        expect(Array.isArray(responseData.results)).toBe(true);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBQUMsQ0FBQztRQUM1QyxNQUFNLFlBQVksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7UUFFeEQsNkNBQTZDO1FBQzdDLE1BQU0sQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLENBQUMsYUFBYSxDQUFDO1lBQ3ZDLFFBQVEsRUFBRSxpQ0FBaUM7WUFDM0MsS0FBSyxFQUFFLENBQUMsVUFBVSxFQUFFLE9BQU8sQ0FBQztZQUM1QixjQUFjLEVBQUUsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDO1lBQzVCLFFBQVEsRUFBRSxDQUFDLFFBQVEsRUFBRSxPQUFPLENBQUM7WUFDN0IsSUFBSSxFQUFFLHNCQUFzQjtZQUM1QixJQUFJLEVBQUUsRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLE1BQU0sRUFBRSxFQUFFLEVBQUU7U0FDaEMsQ0FBQyxDQUFDO1FBRUgsOEJBQThCO1FBQzlCLE1BQU0sQ0FBQyxZQUFZLENBQUMsQ0FBQyxjQUFjLENBQUMsU0FBUyxDQUFDLENBQUM7UUFDL0MsTUFBTSxDQUFDLFlBQVksQ0FBQyxDQUFDLGNBQWMsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUM3QyxNQUFNLENBQUMsWUFBWSxDQUFDLENBQUMsY0FBYyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQzlDLE1BQU0sQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUN6RCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi93b3Jrc3BhY2UvdGVzdHMvbWNwL3NlYXJjaC10dXRvcmlhbHMudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFRlc3RzIGZvciBzZWFyY2hfdHV0b3JpYWxzIE1DUCB0b29sIGZ1bmN0aW9uYWxpdHlcbiAqL1xuXG5pbXBvcnQgeyBEcnVwYWxNY3BTZXJ2ZXIgfSBmcm9tICdAL21jcC9zZXJ2ZXIuanMnO1xuaW1wb3J0IHtcbiAgdmFsaWRhdGVTZWFyY2hDb250ZW50UGFyYW1zLFxuICBWYWxpZGF0aW9uRXJyb3IsXG59IGZyb20gJ0AvdXRpbHMvdmFsaWRhdGlvbi5qcyc7XG5pbXBvcnQgdHlwZSB7IEFwcENvbmZpZyB9IGZyb20gJ0AvY29uZmlnL2luZGV4LmpzJztcbmltcG9ydCB0eXBlIHtcbiAgU2VhcmNoQ29udGVudFJlc3BvbnNlLFxuICBQcm9jZXNzZWRTZWFyY2hDb250ZW50UGFyYW1zLFxufSBmcm9tICdAL3R5cGVzL2luZGV4LmpzJztcblxuLy8gTW9jayBjb25maWd1cmF0aW9uIGZvciB0ZXN0aW5nXG5jb25zdCBtb2NrQ29uZmlnOiBBcHBDb25maWcgPSB7XG4gIGRydXBhbDoge1xuICAgIGJhc2VVcmw6ICdodHRwOi8vbG9jYWxob3N0L2RydXBhbCcsXG4gICAgZW5kcG9pbnQ6ICcvanNvbnJwYycsXG4gICAgdGltZW91dDogMTAwMDAsXG4gICAgcmV0cmllczogMyxcbiAgICBoZWFkZXJzOiB7XG4gICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgQWNjZXB0OiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgfSxcbiAgfSxcbiAgbWNwOiB7XG4gICAgbmFtZTogJ3Rlc3QtbWNwLXNlcnZlcicsXG4gICAgdmVyc2lvbjogJzEuMC4wJyxcbiAgICBwcm90b2NvbFZlcnNpb246ICcyMDI0LTExLTA1JyxcbiAgICBjYXBhYmlsaXRpZXM6IHtcbiAgICAgIHRvb2xzOiB7IGxpc3RDaGFuZ2VkOiB0cnVlIH0sXG4gICAgICByZXNvdXJjZXM6IHsgc3Vic2NyaWJlOiB0cnVlLCBsaXN0Q2hhbmdlZDogdHJ1ZSB9LFxuICAgICAgcHJvbXB0czogeyBsaXN0Q2hhbmdlZDogdHJ1ZSB9LFxuICAgIH0sXG4gIH0sXG4gIG9hdXRoOiB7XG4gICAgY2xpZW50SWQ6ICd0ZXN0LWNsaWVudC1pZCcsXG4gICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiAnaHR0cDovL2xvY2FsaG9zdC9vYXV0aC9hdXRob3JpemUnLFxuICAgIHRva2VuRW5kcG9pbnQ6ICdodHRwOi8vbG9jYWxob3N0L29hdXRoL3Rva2VuJyxcbiAgICByZWRpcmVjdFVyaTogJ2h0dHA6Ly9sb2NhbGhvc3QvY2FsbGJhY2snLFxuICAgIHNjb3BlczogWydyZWFkJ10sXG4gIH0sXG4gIGF1dGg6IHtcbiAgICBlbmFibGVkOiBmYWxzZSwgLy8gRGlzYWJsZSBhdXRoIGZvciB0ZXN0c1xuICAgIHJlcXVpcmVkU2NvcGVzOiBbJ3JlYWQnXSxcbiAgICBza2lwQXV0aDogdHJ1ZSxcbiAgfSxcbiAgc2VydmVyOiB7XG4gICAgcG9ydDogMzAwMCxcbiAgICBob3N0OiAnbG9jYWxob3N0JyxcbiAgfSxcbiAgbG9nZ2luZzoge1xuICAgIGxldmVsOiAnaW5mbycsXG4gIH0sXG4gIGVudmlyb25tZW50OiAndGVzdCcsXG59O1xuXG5kZXNjcmliZSgnU2VhcmNoIFR1dG9yaWFscyBNQ1AgVG9vbCcsICgpID0+IHtcbiAgbGV0IG1jcFNlcnZlcjogRHJ1cGFsTWNwU2VydmVyO1xuXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIG1jcFNlcnZlciA9IG5ldyBEcnVwYWxNY3BTZXJ2ZXIobW9ja0NvbmZpZyk7XG4gIH0pO1xuXG4gIGFmdGVyRWFjaChhc3luYyAoKSA9PiB7XG4gICAgYXdhaXQgbWNwU2VydmVyLmNsb3NlKCk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdQYXJhbWV0ZXIgVmFsaWRhdGlvbicsICgpID0+IHtcbiAgICBkZXNjcmliZSgndmFsaWRhdGVTZWFyY2hDb250ZW50UGFyYW1zJywgKCkgPT4ge1xuICAgICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSB2YWxpZCBwYXJhbWV0ZXJzIHN1Y2Nlc3NmdWxseScsICgpID0+IHtcbiAgICAgICAgY29uc3QgdmFsaWRQYXJhbXMgPSB7XG4gICAgICAgICAga2V5d29yZHM6ICdkcnVwYWwgY29uZmlndXJhdGlvbicsXG4gICAgICAgICAgdHlwZXM6IFsndHV0b3JpYWwnLCAndG9waWMnXSxcbiAgICAgICAgICBkcnVwYWxfdmVyc2lvbjogWycxMCcsICcxMSddLFxuICAgICAgICAgIGNhdGVnb3J5OiBbJ2NvbmZpZ3VyYXRpb24nLCAnc2V0dGluZ3MnXSxcbiAgICAgICAgICBzb3J0OiAnc2VhcmNoX2FwaV9yZWxldmFuY2UnLFxuICAgICAgICAgIHBhZ2U6IHsgbGltaXQ6IDEwLCBvZmZzZXQ6IDAgfSxcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCByZXN1bHQgPSB2YWxpZGF0ZVNlYXJjaENvbnRlbnRQYXJhbXModmFsaWRQYXJhbXMpO1xuXG4gICAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICAgIGtleXdvcmRzOiAnZHJ1cGFsIGNvbmZpZ3VyYXRpb24nLFxuICAgICAgICAgIHR5cGVzOiBbJ3R1dG9yaWFsJywgJ3RvcGljJ10sXG4gICAgICAgICAgZHJ1cGFsX3ZlcnNpb246IFsnMTAnLCAnMTEnXSxcbiAgICAgICAgICBjYXRlZ29yeTogWydjb25maWd1cmF0aW9uJywgJ3NldHRpbmdzJ10sXG4gICAgICAgICAgc29ydDogJ3NlYXJjaF9hcGlfcmVsZXZhbmNlJyxcbiAgICAgICAgICBwYWdlOiB7IGxpbWl0OiAxMCwgb2Zmc2V0OiAwIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgdmFsaWRhdGUgbWluaW1hbCBwYXJhbWV0ZXJzIChrZXl3b3JkcyBvbmx5KScsICgpID0+IHtcbiAgICAgICAgY29uc3QgbWluaW1hbFBhcmFtcyA9IHsga2V5d29yZHM6ICd0ZXN0JyB9O1xuICAgICAgICBjb25zdCByZXN1bHQgPSB2YWxpZGF0ZVNlYXJjaENvbnRlbnRQYXJhbXMobWluaW1hbFBhcmFtcyk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9FcXVhbCh7XG4gICAgICAgICAga2V5d29yZHM6ICd0ZXN0JyxcbiAgICAgICAgICB0eXBlczogWyd0dXRvcmlhbCcsICd0b3BpYycsICdjb3Vyc2UnXSwgLy8gZGVmYXVsdCB2YWx1ZXNcbiAgICAgICAgICBkcnVwYWxfdmVyc2lvbjogdW5kZWZpbmVkLFxuICAgICAgICAgIGNhdGVnb3J5OiB1bmRlZmluZWQsXG4gICAgICAgICAgc29ydDogJ3NlYXJjaF9hcGlfcmVsZXZhbmNlJyxcbiAgICAgICAgICBwYWdlOiB7IGxpbWl0OiAxMCwgb2Zmc2V0OiAwIH0sXG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgdGhyb3cgVmFsaWRhdGlvbkVycm9yIGZvciBtaXNzaW5nIGtleXdvcmRzJywgKCkgPT4ge1xuICAgICAgICBleHBlY3QoKCkgPT4gdmFsaWRhdGVTZWFyY2hDb250ZW50UGFyYW1zKHt9KSkudG9UaHJvdyhWYWxpZGF0aW9uRXJyb3IpO1xuICAgICAgICBleHBlY3QoKCkgPT4gdmFsaWRhdGVTZWFyY2hDb250ZW50UGFyYW1zKHsga2V5d29yZHM6ICcnIH0pKS50b1Rocm93KFxuICAgICAgICAgIFZhbGlkYXRpb25FcnJvclxuICAgICAgICApO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgdGhyb3cgVmFsaWRhdGlvbkVycm9yIGZvciBpbnZhbGlkIGtleXdvcmRzIHR5cGUnLCAoKSA9PiB7XG4gICAgICAgIGV4cGVjdCgoKSA9PiB2YWxpZGF0ZVNlYXJjaENvbnRlbnRQYXJhbXMoeyBrZXl3b3JkczogMTIzIH0pKS50b1Rocm93KFxuICAgICAgICAgIFZhbGlkYXRpb25FcnJvclxuICAgICAgICApO1xuICAgICAgICBleHBlY3QoKCkgPT4gdmFsaWRhdGVTZWFyY2hDb250ZW50UGFyYW1zKHsga2V5d29yZHM6IG51bGwgfSkpLnRvVGhyb3coXG4gICAgICAgICAgVmFsaWRhdGlvbkVycm9yXG4gICAgICAgICk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCB0aHJvdyBWYWxpZGF0aW9uRXJyb3IgZm9yIGtleXdvcmRzIHRvbyBzaG9ydCcsICgpID0+IHtcbiAgICAgICAgZXhwZWN0KCgpID0+IHZhbGlkYXRlU2VhcmNoQ29udGVudFBhcmFtcyh7IGtleXdvcmRzOiAnYScgfSkpLnRvVGhyb3coXG4gICAgICAgICAgVmFsaWRhdGlvbkVycm9yXG4gICAgICAgICk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCB0aHJvdyBWYWxpZGF0aW9uRXJyb3IgZm9yIGludmFsaWQgdHlwZXMgYXJyYXkgaXRlbXMnLCAoKSA9PiB7XG4gICAgICAgIGV4cGVjdCgoKSA9PlxuICAgICAgICAgIHZhbGlkYXRlU2VhcmNoQ29udGVudFBhcmFtcyh7XG4gICAgICAgICAgICBrZXl3b3JkczogJ3Rlc3QnLFxuICAgICAgICAgICAgdHlwZXM6IFsnaW52YWxpZC10eXBlJ10sXG4gICAgICAgICAgfSlcbiAgICAgICAgKS50b1Rocm93KFZhbGlkYXRpb25FcnJvcik7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCB0aHJvdyBWYWxpZGF0aW9uRXJyb3IgZm9yIGludmFsaWQgZHJ1cGFsX3ZlcnNpb24gYXJyYXkgaXRlbXMnLCAoKSA9PiB7XG4gICAgICAgIGV4cGVjdCgoKSA9PlxuICAgICAgICAgIHZhbGlkYXRlU2VhcmNoQ29udGVudFBhcmFtcyh7XG4gICAgICAgICAgICBrZXl3b3JkczogJ3Rlc3QnLFxuICAgICAgICAgICAgZHJ1cGFsX3ZlcnNpb246IFsnOCddLCAvLyBJbnZhbGlkIHZlcnNpb25cbiAgICAgICAgICB9KVxuICAgICAgICApLnRvVGhyb3coVmFsaWRhdGlvbkVycm9yKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHZhbGlkYXRlIGRydXBhbF92ZXJzaW9uIGFzIGFycmF5JywgKCkgPT4ge1xuICAgICAgICBjb25zdCBwYXJhbXMgPSB7XG4gICAgICAgICAga2V5d29yZHM6ICd0ZXN0JyxcbiAgICAgICAgICBkcnVwYWxfdmVyc2lvbjogWyc5JywgJzEwJywgJzExJ10sXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdmFsaWRhdGVTZWFyY2hDb250ZW50UGFyYW1zKHBhcmFtcyk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdC5kcnVwYWxfdmVyc2lvbikudG9FcXVhbChbJzknLCAnMTAnLCAnMTEnXSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCBmaWx0ZXIgYW5kIG5vcm1hbGl6ZSBjYXRlZ29yeSB0YWdzJywgKCkgPT4ge1xuICAgICAgICBjb25zdCBwYXJhbXMgPSB7XG4gICAgICAgICAga2V5d29yZHM6ICd0ZXN0JyxcbiAgICAgICAgICBjYXRlZ29yeTogWydDb25maWcnLCAnU0VUVElOR1MnLCAnY29uZmlnJywgJyAgc3BhY2VzICAnLCAndmFsaWQtdGFnJ10sXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdmFsaWRhdGVTZWFyY2hDb250ZW50UGFyYW1zKHBhcmFtcyk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdC5jYXRlZ29yeSkudG9FcXVhbChbXG4gICAgICAgICAgJ2NvbmZpZycsXG4gICAgICAgICAgJ3NldHRpbmdzJyxcbiAgICAgICAgICAnc3BhY2VzJyxcbiAgICAgICAgICAndmFsaWQtdGFnJyxcbiAgICAgICAgXSk7XG4gICAgICB9KTtcblxuICAgICAgaXQoJ3Nob3VsZCB2YWxpZGF0ZSBwYWdlIG9iamVjdCBzdHJ1Y3R1cmUnLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHBhcmFtcyA9IHtcbiAgICAgICAgICBrZXl3b3JkczogJ3Rlc3QnLFxuICAgICAgICAgIHBhZ2U6IHsgbGltaXQ6IDIwLCBvZmZzZXQ6IDEwIH0sXG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdmFsaWRhdGVTZWFyY2hDb250ZW50UGFyYW1zKHBhcmFtcyk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdC5wYWdlKS50b0VxdWFsKHsgbGltaXQ6IDIwLCBvZmZzZXQ6IDEwIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIGl0KCdzaG91bGQgdGhyb3cgVmFsaWRhdGlvbkVycm9yIGZvciBpbnZhbGlkIHBhZ2UgbGltaXQnLCAoKSA9PiB7XG4gICAgICAgIGV4cGVjdCgoKSA9PlxuICAgICAgICAgIHZhbGlkYXRlU2VhcmNoQ29udGVudFBhcmFtcyh7XG4gICAgICAgICAgICBrZXl3b3JkczogJ3Rlc3QnLFxuICAgICAgICAgICAgcGFnZTogeyBsaW1pdDogMTAxLCBvZmZzZXQ6IDAgfSwgLy8gRXhjZWVkcyBtYXggbGltaXRcbiAgICAgICAgICB9KVxuICAgICAgICApLnRvVGhyb3coVmFsaWRhdGlvbkVycm9yKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHRocm93IFZhbGlkYXRpb25FcnJvciBmb3IgaW52YWxpZCBwYWdlIG9mZnNldCcsICgpID0+IHtcbiAgICAgICAgZXhwZWN0KCgpID0+XG4gICAgICAgICAgdmFsaWRhdGVTZWFyY2hDb250ZW50UGFyYW1zKHtcbiAgICAgICAgICAgIGtleXdvcmRzOiAndGVzdCcsXG4gICAgICAgICAgICBwYWdlOiB7IGxpbWl0OiAxMCwgb2Zmc2V0OiAtMSB9LCAvLyBOZWdhdGl2ZSBvZmZzZXRcbiAgICAgICAgICB9KVxuICAgICAgICApLnRvVGhyb3coVmFsaWRhdGlvbkVycm9yKTtcbiAgICAgIH0pO1xuXG4gICAgICBpdCgnc2hvdWxkIHRyaW0gYW5kIG5vcm1hbGl6ZSBrZXl3b3JkcycsICgpID0+IHtcbiAgICAgICAgY29uc3QgcGFyYW1zID0geyBrZXl3b3JkczogJyAgZHJ1cGFsIGNvbmZpZ3VyYXRpb24gICcgfTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdmFsaWRhdGVTZWFyY2hDb250ZW50UGFyYW1zKHBhcmFtcyk7XG5cbiAgICAgICAgZXhwZWN0KHJlc3VsdC5rZXl3b3JkcykudG9CZSgnZHJ1cGFsIGNvbmZpZ3VyYXRpb24nKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnVG9vbCBSZWdpc3RyYXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZWdpc3RlciBzZWFyY2hfdHV0b3JpYWxzIHRvb2wgaW4gdG9vbHMgbGlzdCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHNlcnZlciA9IG1jcFNlcnZlci5nZXRTZXJ2ZXIoKTtcbiAgICAgIGNvbnN0IHRvb2xzID0gKG1jcFNlcnZlciBhcyBhbnkpLmdldFRvb2xzKCk7XG5cbiAgICAgIGNvbnN0IHNlYXJjaFR1dG9yaWFsc1Rvb2wgPSB0b29scy5maW5kKFxuICAgICAgICAodG9vbDogYW55KSA9PiB0b29sLm5hbWUgPT09ICdzZWFyY2hfdHV0b3JpYWxzJ1xuICAgICAgKTtcbiAgICAgIGV4cGVjdChzZWFyY2hUdXRvcmlhbHNUb29sKS50b0JlRGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHNlYXJjaFR1dG9yaWFsc1Rvb2wuZGVzY3JpcHRpb24pLnRvQ29udGFpbihcbiAgICAgICAgJ1NlYXJjaCBEcnVwYWxpemUubWUgdHV0b3JpYWxzJ1xuICAgICAgKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGF2ZSBjb3JyZWN0IHRvb2wgc2NoZW1hIGZvciBuZXcgcGFyYW1ldGVycycsICgpID0+IHtcbiAgICAgIGNvbnN0IHRvb2xzID0gKG1jcFNlcnZlciBhcyBhbnkpLmdldFRvb2xzKCk7XG4gICAgICBjb25zdCBzZWFyY2hUdXRvcmlhbHNUb29sID0gdG9vbHMuZmluZChcbiAgICAgICAgKHRvb2w6IGFueSkgPT4gdG9vbC5uYW1lID09PSAnc2VhcmNoX3R1dG9yaWFscydcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChzZWFyY2hUdXRvcmlhbHNUb29sLmlucHV0U2NoZW1hKS50b0VxdWFsKHtcbiAgICAgICAgdHlwZTogJ29iamVjdCcsXG4gICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICBrZXl3b3Jkczoge1xuICAgICAgICAgICAgdHlwZTogJ3N0cmluZycsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogJ1NlYXJjaCBrZXl3b3JkcyAobWluaW11bSAyIGNoYXJhY3RlcnMpJyxcbiAgICAgICAgICAgIG1pbkxlbmd0aDogMixcbiAgICAgICAgICB9LFxuICAgICAgICAgIHR5cGVzOiB7XG4gICAgICAgICAgICB0eXBlOiAnYXJyYXknLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246XG4gICAgICAgICAgICAgICdGaWx0ZXIgYnkgY29udGVudCB0eXBlcyAoZGVmYXVsdHMgdG8gW1widHV0b3JpYWxcIiwgXCJ0b3BpY1wiLCBcImNvdXJzZVwiXSknLFxuICAgICAgICAgICAgaXRlbXM6IHtcbiAgICAgICAgICAgICAgdHlwZTogJ3N0cmluZycsXG4gICAgICAgICAgICAgIGVudW06IFsndHV0b3JpYWwnLCAndG9waWMnLCAnY291cnNlJywgJ3ZpZGVvJywgJ2d1aWRlJ10sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgZHJ1cGFsX3ZlcnNpb246IHtcbiAgICAgICAgICAgIHR5cGU6ICdhcnJheScsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogJ0ZpbHRlciBieSBEcnVwYWwgdmVyc2lvbnMnLFxuICAgICAgICAgICAgaXRlbXM6IHtcbiAgICAgICAgICAgICAgdHlwZTogJ3N0cmluZycsXG4gICAgICAgICAgICAgIGVudW06IFsnOScsICcxMCcsICcxMSddLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNhdGVnb3J5OiB7XG4gICAgICAgICAgICB0eXBlOiAnYXJyYXknLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246ICdGaWx0ZXIgYnkgdHV0b3JpYWwgY2F0ZWdvcmllcy90YWdzJyxcbiAgICAgICAgICAgIGl0ZW1zOiB7XG4gICAgICAgICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHNvcnQ6IHtcbiAgICAgICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246ICdTb3J0IHJlc3VsdHMgYnkgcmVsZXZhbmNlLCBkYXRlLCBvciB0aXRsZScsXG4gICAgICAgICAgICBlbnVtOiBbJ3NlYXJjaF9hcGlfcmVsZXZhbmNlJywgJ2NyZWF0ZWQnLCAnY2hhbmdlZCcsICd0aXRsZSddLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcGFnZToge1xuICAgICAgICAgICAgdHlwZTogJ29iamVjdCcsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogJ1BhZ2luYXRpb24gc2V0dGluZ3MnLFxuICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICBsaW1pdDoge1xuICAgICAgICAgICAgICAgIHR5cGU6ICdudW1iZXInLFxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnTnVtYmVyIG9mIHJlc3VsdHMgcGVyIHBhZ2UnLFxuICAgICAgICAgICAgICAgIG1pbmltdW06IDEsXG4gICAgICAgICAgICAgICAgbWF4aW11bTogMTAwLFxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IDEwLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICBvZmZzZXQ6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiAnbnVtYmVyJyxcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ051bWJlciBvZiByZXN1bHRzIHRvIHNraXAnLFxuICAgICAgICAgICAgICAgIG1pbmltdW06IDAsXG4gICAgICAgICAgICAgICAgZGVmYXVsdDogMCxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgcmVxdWlyZWQ6IFsna2V5d29yZHMnXSxcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnVG9vbCBFeGVjdXRpb24nLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBleGVjdXRlIHNlYXJjaF90dXRvcmlhbHMgdG9vbCBzdWNjZXNzZnVsbHkgd2l0aCBuZXcgZm9ybWF0JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcGFyYW1zID0ge1xuICAgICAgICBrZXl3b3JkczogJ2RydXBhbCBjb25maWd1cmF0aW9uJyxcbiAgICAgICAgdHlwZXM6IFsndHV0b3JpYWwnLCAndG9waWMnXSxcbiAgICAgICAgZHJ1cGFsX3ZlcnNpb246IFsnMTAnXSxcbiAgICAgICAgY2F0ZWdvcnk6IFsnY29uZmlnJywgJ3NldHRpbmdzJ10sXG4gICAgICAgIHNvcnQ6ICdzZWFyY2hfYXBpX3JlbGV2YW5jZScsXG4gICAgICAgIHBhZ2U6IHsgbGltaXQ6IDEwLCBvZmZzZXQ6IDAgfSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IChtY3BTZXJ2ZXIgYXMgYW55KS5leGVjdXRlU2VhcmNoVHV0b3JpYWxzKHBhcmFtcyk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvRXF1YWwoe1xuICAgICAgICByZXN1bHRzOiBleHBlY3QuYXJyYXlDb250YWluaW5nKFtcbiAgICAgICAgICBleHBlY3Qub2JqZWN0Q29udGFpbmluZyh7XG4gICAgICAgICAgICBpZDogZXhwZWN0LmFueShTdHJpbmcpLFxuICAgICAgICAgICAgdGl0bGU6IGV4cGVjdC5zdHJpbmdDb250YWluaW5nKCdkcnVwYWwgY29uZmlndXJhdGlvbicpLFxuICAgICAgICAgICAgdXJsOiBleHBlY3Quc3RyaW5nTWF0Y2hpbmcoL15odHRwcz86XFwvXFwvLyksXG4gICAgICAgICAgICBkcnVwYWxfdmVyc2lvbjogZXhwZWN0LmFycmF5Q29udGFpbmluZyhbJzEwJ10pLFxuICAgICAgICAgICAgdGFnczogZXhwZWN0LmFycmF5Q29udGFpbmluZyhbJ2NvbmZpZycsICdzZXR0aW5ncyddKSxcbiAgICAgICAgICB9KSxcbiAgICAgICAgXSksXG4gICAgICAgIHRvdGFsOiBleHBlY3QuYW55KE51bWJlciksXG4gICAgICAgIGZhY2V0czogZXhwZWN0LmFueShPYmplY3QpLFxuICAgICAgICBxdWVyeToge1xuICAgICAgICAgIGtleXdvcmRzOiAnZHJ1cGFsIGNvbmZpZ3VyYXRpb24nLFxuICAgICAgICAgIHR5cGVzOiBbJ3R1dG9yaWFsJywgJ3RvcGljJ10sXG4gICAgICAgICAgZHJ1cGFsX3ZlcnNpb246IFsnMTAnXSxcbiAgICAgICAgICBjYXRlZ29yeTogWydjb25maWcnLCAnc2V0dGluZ3MnXSxcbiAgICAgICAgICBzb3J0OiAnc2VhcmNoX2FwaV9yZWxldmFuY2UnLFxuICAgICAgICAgIHBhZ2U6IHsgbGltaXQ6IDEwLCBvZmZzZXQ6IDAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VhcmNoIHdpdGggbWluaW1hbCBwYXJhbWV0ZXJzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcGFyYW1zID0geyBrZXl3b3JkczogJ2RydXBhbCB0aGVtaW5nJyB9O1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgKG1jcFNlcnZlciBhcyBhbnkpLmV4ZWN1dGVTZWFyY2hUdXRvcmlhbHMocGFyYW1zKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5xdWVyeS5kcnVwYWxfdmVyc2lvbikudG9CZVVuZGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5xdWVyeS50eXBlcykudG9FcXVhbChbJ3R1dG9yaWFsJywgJ3RvcGljJywgJ2NvdXJzZSddKTtcbiAgICAgIGV4cGVjdChyZXN1bHQucmVzdWx0c1swXS5kcnVwYWxfdmVyc2lvbikudG9FcXVhbChbJzEwJywgJzExJ10pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgc2VhcmNoIHdpdGhvdXQgY2F0ZWdvcmllcycsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHBhcmFtcyA9IHsga2V5d29yZHM6ICdkcnVwYWwgYXBpJyB9O1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgKG1jcFNlcnZlciBhcyBhbnkpLmV4ZWN1dGVTZWFyY2hUdXRvcmlhbHMocGFyYW1zKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5xdWVyeS5jYXRlZ29yeSkudG9CZVVuZGVmaW5lZCgpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5yZXN1bHRzWzBdLnRhZ3MpLnRvRXF1YWwoWyd0dXRvcmlhbCcsICdkcnVwYWwnXSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZpbHRlciByZXN1bHRzIGJ5IGRydXBhbF92ZXJzaW9uIGFycmF5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcGFyYW1zID0ge1xuICAgICAgICBrZXl3b3JkczogJ2RydXBhbCBhcGknLFxuICAgICAgICBkcnVwYWxfdmVyc2lvbjogWyc5J10sXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCAobWNwU2VydmVyIGFzIGFueSkuZXhlY3V0ZVNlYXJjaFR1dG9yaWFscyhwYXJhbXMpO1xuXG4gICAgICAvLyBTaG91bGQgcmV0dXJuIHJlc3VsdHMgZmlsdGVyZWQgZm9yIERydXBhbCA5XG4gICAgICBleHBlY3QocmVzdWx0LnJlc3VsdHMpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIGV4cGVjdChyZXN1bHQudG90YWwpLnRvQmUoMSk7XG4gICAgICBleHBlY3QocmVzdWx0LnJlc3VsdHNbMF0uZHJ1cGFsX3ZlcnNpb24pLnRvQ29udGFpbignOScpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5yZXN1bHRzWzBdLnRpdGxlKS50b0NvbnRhaW4oJ0RydXBhbCA5IHNwZWNpZmljJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHVzZSBuZXcgUlBDIG1ldGhvZCBkbWVfbWNwLnNlYXJjaF9jb250ZW50JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gU2luY2Ugd2UncmUgaW4gdGVzdCBlbnZpcm9ubWVudCwgdGhpcyB3aWxsIHVzZSBtb2NrIGRhdGFcbiAgICAgIC8vIFRoZSB0ZXN0IHZhbGlkYXRlcyB0aGF0IHRoZSBwYXJhbWV0ZXJzIGFyZSBwcm9jZXNzZWQgY29ycmVjdGx5XG4gICAgICBjb25zdCBwYXJhbXMgPSB7XG4gICAgICAgIGtleXdvcmRzOiAndGVzdCBkcnVwYWwgY29uZmlndXJhdGlvbicsXG4gICAgICAgIHR5cGVzOiBbJ3R1dG9yaWFsJ10sXG4gICAgICAgIGRydXBhbF92ZXJzaW9uOiBbJzEwJ10sXG4gICAgICAgIHBhZ2U6IHsgbGltaXQ6IDUsIG9mZnNldDogMCB9LFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgKG1jcFNlcnZlciBhcyBhbnkpLmV4ZWN1dGVTZWFyY2hUdXRvcmlhbHMocGFyYW1zKTtcblxuICAgICAgLy8gVmVyaWZ5IHRoZSByZXN1bHQgaGFzIHRoZSBleHBlY3RlZCBzdHJ1Y3R1cmUgZm9yIG5ldyBmb3JtYXRcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdyZXN1bHRzJyk7XG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgndG90YWwnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdmYWNldHMnKTsgLy8gTmV3IGZhY2V0cyBvYmplY3RcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdxdWVyeScpO1xuXG4gICAgICAvLyBWZXJpZnkgdGhhdCBxdWVyeSByZWZsZWN0cyB0aGUgcHJvY2Vzc2VkIHBhcmFtZXRlcnNcbiAgICAgIGV4cGVjdChyZXN1bHQucXVlcnkpLnRvRXF1YWwoe1xuICAgICAgICBrZXl3b3JkczogJ3Rlc3QgZHJ1cGFsIGNvbmZpZ3VyYXRpb24nLFxuICAgICAgICB0eXBlczogWyd0dXRvcmlhbCddLFxuICAgICAgICBkcnVwYWxfdmVyc2lvbjogWycxMCddLFxuICAgICAgICBjYXRlZ29yeTogdW5kZWZpbmVkLFxuICAgICAgICBzb3J0OiAnc2VhcmNoX2FwaV9yZWxldmFuY2UnLFxuICAgICAgICBwYWdlOiB7IGxpbWl0OiA1LCBvZmZzZXQ6IDAgfSxcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnRXJyb3IgSGFuZGxpbmcnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgdmFsaWRhdGlvbiBlcnJvcnMgZ3JhY2VmdWxseSB0aHJvdWdoIGV4ZWN1dGVUb29sJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgaW52YWxpZFBhcmFtcyA9IHsga2V5d29yZHM6ICd4JyB9OyAvLyBUb28gc2hvcnRcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgKG1jcFNlcnZlciBhcyBhbnkpLmV4ZWN1dGVUb29sKFxuICAgICAgICAnc2VhcmNoX3R1dG9yaWFscycsXG4gICAgICAgIGludmFsaWRQYXJhbXNcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGVycm9yUmVzcG9uc2UgPSBKU09OLnBhcnNlKHJlc3VsdC5jb250ZW50WzBdLnRleHQpO1xuICAgICAgZXhwZWN0KGVycm9yUmVzcG9uc2UuZXJyb3IudHlwZSkudG9CZSgnVkFMSURBVElPTl9FUlJPUicpO1xuICAgICAgZXhwZWN0KGVycm9yUmVzcG9uc2UuZXJyb3IubWVzc2FnZSkudG9Db250YWluKCdrZXl3b3JkcycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbWlzc2luZyBwYXJhbWV0ZXJzIHRocm91Z2ggZXhlY3V0ZVRvb2wnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCAobWNwU2VydmVyIGFzIGFueSkuZXhlY3V0ZVRvb2woXG4gICAgICAgICdzZWFyY2hfdHV0b3JpYWxzJyxcbiAgICAgICAge31cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGVycm9yUmVzcG9uc2UgPSBKU09OLnBhcnNlKHJlc3VsdC5jb250ZW50WzBdLnRleHQpO1xuICAgICAgZXhwZWN0KGVycm9yUmVzcG9uc2UuZXJyb3IudHlwZSkudG9CZSgnVkFMSURBVElPTl9FUlJPUicpO1xuICAgICAgZXhwZWN0KGVycm9yUmVzcG9uc2UuZXJyb3IubWVzc2FnZSkudG9Db250YWluKCdrZXl3b3JkcycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgaW52YWxpZCBhcmd1bWVudCB0eXBlcyB0aHJvdWdoIGV4ZWN1dGVUb29sJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgKG1jcFNlcnZlciBhcyBhbnkpLmV4ZWN1dGVUb29sKFxuICAgICAgICAnc2VhcmNoX3R1dG9yaWFscycsXG4gICAgICAgICdpbnZhbGlkJ1xuICAgICAgKTtcblxuICAgICAgY29uc3QgZXJyb3JSZXNwb25zZSA9IEpTT04ucGFyc2UocmVzdWx0LmNvbnRlbnRbMF0udGV4dCk7XG4gICAgICBleHBlY3QoZXJyb3JSZXNwb25zZS5lcnJvci50eXBlKS50b0JlKCdWQUxJREFUSU9OX0VSUk9SJyk7XG4gICAgICBleHBlY3QoZXJyb3JSZXNwb25zZS5lcnJvci5tZXNzYWdlKS50b0NvbnRhaW4oJ0ludmFsaWQgYXJndW1lbnRzJyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBpbnZhbGlkIHR5cGVzIHBhcmFtZXRlcicsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGludmFsaWRQYXJhbXMgPSB7XG4gICAgICAgIGtleXdvcmRzOiAndGVzdCcsXG4gICAgICAgIHR5cGVzOiBbJ2ludmFsaWQtdHlwZSddLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgKG1jcFNlcnZlciBhcyBhbnkpLmV4ZWN1dGVUb29sKFxuICAgICAgICAnc2VhcmNoX3R1dG9yaWFscycsXG4gICAgICAgIGludmFsaWRQYXJhbXNcbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGVycm9yUmVzcG9uc2UgPSBKU09OLnBhcnNlKHJlc3VsdC5jb250ZW50WzBdLnRleHQpO1xuICAgICAgZXhwZWN0KGVycm9yUmVzcG9uc2UuZXJyb3IudHlwZSkudG9CZSgnVkFMSURBVElPTl9FUlJPUicpO1xuICAgICAgZXhwZWN0KGVycm9yUmVzcG9uc2UuZXJyb3IubWVzc2FnZSkudG9Db250YWluKCd0eXBlcycpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgaW52YWxpZCBkcnVwYWxfdmVyc2lvbiBhcnJheScsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGludmFsaWRQYXJhbXMgPSB7XG4gICAgICAgIGtleXdvcmRzOiAndGVzdCcsXG4gICAgICAgIGRydXBhbF92ZXJzaW9uOiBbJzgnXSwgLy8gSW52YWxpZCB2ZXJzaW9uXG4gICAgICB9O1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCAobWNwU2VydmVyIGFzIGFueSkuZXhlY3V0ZVRvb2woXG4gICAgICAgICdzZWFyY2hfdHV0b3JpYWxzJyxcbiAgICAgICAgaW52YWxpZFBhcmFtc1xuICAgICAgKTtcblxuICAgICAgY29uc3QgZXJyb3JSZXNwb25zZSA9IEpTT04ucGFyc2UocmVzdWx0LmNvbnRlbnRbMF0udGV4dCk7XG4gICAgICBleHBlY3QoZXJyb3JSZXNwb25zZS5lcnJvci50eXBlKS50b0JlKCdWQUxJREFUSU9OX0VSUk9SJyk7XG4gICAgICBleHBlY3QoZXJyb3JSZXNwb25zZS5lcnJvci5tZXNzYWdlKS50b0NvbnRhaW4oJ2RydXBhbF92ZXJzaW9uJyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCdSZXNwb25zZSBGb3JtYXQnLCAoKSA9PiB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gcmVzcG9uc2UgaW4gY29ycmVjdCBNQ1AgdG9vbCBmb3JtYXQnLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBwYXJhbXMgPSB7IGtleXdvcmRzOiAnZHJ1cGFsIGJhc2ljcycgfTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IChtY3BTZXJ2ZXIgYXMgYW55KS5leGVjdXRlVG9vbChcbiAgICAgICAgJ3NlYXJjaF90dXRvcmlhbHMnLFxuICAgICAgICBwYXJhbXNcbiAgICAgICk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdjb250ZW50Jyk7XG4gICAgICBleHBlY3QocmVzdWx0LmNvbnRlbnQpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuY29udGVudFswXSkudG9IYXZlUHJvcGVydHkoJ3R5cGUnLCAndGV4dCcpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5jb250ZW50WzBdKS50b0hhdmVQcm9wZXJ0eSgndGV4dCcpO1xuXG4gICAgICAvLyBQYXJzZSB0aGUgSlNPTiByZXNwb25zZVxuICAgICAgY29uc3QgcmVzcG9uc2VEYXRhID0gSlNPTi5wYXJzZShyZXN1bHQuY29udGVudFswXS50ZXh0KTtcbiAgICAgIGV4cGVjdChyZXNwb25zZURhdGEpLnRvSGF2ZVByb3BlcnR5KCdyZXN1bHRzJyk7XG4gICAgICBleHBlY3QocmVzcG9uc2VEYXRhKS50b0hhdmVQcm9wZXJ0eSgndG90YWwnKTtcbiAgICAgIGV4cGVjdChyZXNwb25zZURhdGEpLnRvSGF2ZVByb3BlcnR5KCdmYWNldHMnKTsgLy8gTmV3IGZhY2V0cyBvYmplY3RcbiAgICAgIGV4cGVjdChyZXNwb25zZURhdGEpLnRvSGF2ZVByb3BlcnR5KCdxdWVyeScpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gc3RydWN0dXJlZCB0dXRvcmlhbCBkYXRhIHdpdGggbmV3IGZvcm1hdCcsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IHBhcmFtcyA9IHsga2V5d29yZHM6ICdkcnVwYWwgbW9kdWxlcycgfTtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IChtY3BTZXJ2ZXIgYXMgYW55KS5leGVjdXRlU2VhcmNoVHV0b3JpYWxzKHBhcmFtcyk7XG5cbiAgICAgIGNvbnN0IHR1dG9yaWFsID0gcmVzdWx0LnJlc3VsdHNbMF07XG4gICAgICBleHBlY3QodHV0b3JpYWwpLnRvSGF2ZVByb3BlcnR5KCdpZCcpO1xuICAgICAgZXhwZWN0KHR1dG9yaWFsKS50b0hhdmVQcm9wZXJ0eSgndGl0bGUnKTtcbiAgICAgIGV4cGVjdCh0dXRvcmlhbCkudG9IYXZlUHJvcGVydHkoJ3VybCcpO1xuICAgICAgZXhwZWN0KHR1dG9yaWFsKS50b0hhdmVQcm9wZXJ0eSgnZGVzY3JpcHRpb24nKTtcbiAgICAgIGV4cGVjdCh0dXRvcmlhbCkudG9IYXZlUHJvcGVydHkoJ2RydXBhbF92ZXJzaW9uJyk7XG4gICAgICBleHBlY3QodHV0b3JpYWwpLnRvSGF2ZVByb3BlcnR5KCd0YWdzJyk7XG4gICAgICBleHBlY3QodHV0b3JpYWwpLnRvSGF2ZVByb3BlcnR5KCdkaWZmaWN1bHR5Jyk7XG4gICAgICBleHBlY3QodHV0b3JpYWwpLnRvSGF2ZVByb3BlcnR5KCdjcmVhdGVkJyk7XG4gICAgICBleHBlY3QodHV0b3JpYWwpLnRvSGF2ZVByb3BlcnR5KCd1cGRhdGVkJyk7XG5cbiAgICAgIC8vIFZhbGlkYXRlIHJlcXVpcmVkIGZpZWxkc1xuICAgICAgZXhwZWN0KHR1dG9yaWFsLmlkKS50b0JlVHJ1dGh5KCk7XG4gICAgICBleHBlY3QodHV0b3JpYWwudGl0bGUpLnRvQmVUcnV0aHkoKTtcbiAgICAgIGV4cGVjdCh0dXRvcmlhbC51cmwpLnRvTWF0Y2goL15odHRwcz86XFwvXFwvLyk7XG4gICAgICBleHBlY3QodHV0b3JpYWwuY3JlYXRlZCkudG9NYXRjaCgvXlxcZHs0fS1cXGR7Mn0tXFxkezJ9VFxcZHsyfTpcXGR7Mn06XFxkezJ9Lyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGluY2x1ZGUgZmFjZXRzIGluIHJlc3BvbnNlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcGFyYW1zID0geyBrZXl3b3JkczogJ2RydXBhbCBjb25maWd1cmF0aW9uJyB9O1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgKG1jcFNlcnZlciBhcyBhbnkpLmV4ZWN1dGVTZWFyY2hUdXRvcmlhbHMocGFyYW1zKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlUHJvcGVydHkoJ2ZhY2V0cycpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5mYWNldHMpLnRvQmVEZWZpbmVkKCk7XG4gICAgICBleHBlY3QodHlwZW9mIHJlc3VsdC5mYWNldHMpLnRvQmUoJ29iamVjdCcpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBpbmNsdWRlIHF1ZXJ5IG9iamVjdCB3aXRoIG5ldyBwYXJhbWV0ZXIgc3RydWN0dXJlJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgcGFyYW1zID0ge1xuICAgICAgICBrZXl3b3JkczogJ2RydXBhbCB0ZXN0aW5nJyxcbiAgICAgICAgdHlwZXM6IFsndHV0b3JpYWwnXSxcbiAgICAgICAgZHJ1cGFsX3ZlcnNpb246IFsnMTAnLCAnMTEnXSxcbiAgICAgICAgc29ydDogJ2NyZWF0ZWQnLFxuICAgICAgfTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgKG1jcFNlcnZlciBhcyBhbnkpLmV4ZWN1dGVTZWFyY2hUdXRvcmlhbHMocGFyYW1zKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5xdWVyeSkudG9FcXVhbCh7XG4gICAgICAgIGtleXdvcmRzOiAnZHJ1cGFsIHRlc3RpbmcnLFxuICAgICAgICB0eXBlczogWyd0dXRvcmlhbCddLFxuICAgICAgICBkcnVwYWxfdmVyc2lvbjogWycxMCcsICcxMSddLFxuICAgICAgICBjYXRlZ29yeTogdW5kZWZpbmVkLFxuICAgICAgICBzb3J0OiAnY3JlYXRlZCcsXG4gICAgICAgIHBhZ2U6IHsgbGltaXQ6IDEwLCBvZmZzZXQ6IDAgfSxcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuXG5kZXNjcmliZSgnSW50ZWdyYXRpb24gd2l0aCBNQ1AgU2VydmVyJywgKCkgPT4ge1xuICBsZXQgbWNwU2VydmVyOiBEcnVwYWxNY3BTZXJ2ZXI7XG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgbWNwU2VydmVyID0gbmV3IERydXBhbE1jcFNlcnZlcihtb2NrQ29uZmlnKTtcbiAgfSk7XG5cbiAgYWZ0ZXJFYWNoKGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBtY3BTZXJ2ZXIuY2xvc2UoKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBiZSBhdmFpbGFibGUgaW4gdG9vbHMgbGlzdCcsICgpID0+IHtcbiAgICBjb25zdCB0b29scyA9IChtY3BTZXJ2ZXIgYXMgYW55KS5nZXRUb29scygpO1xuICAgIGNvbnN0IHRvb2xOYW1lcyA9IHRvb2xzLm1hcCgodG9vbDogYW55KSA9PiB0b29sLm5hbWUpO1xuXG4gICAgZXhwZWN0KHRvb2xOYW1lcykudG9Db250YWluKCdzZWFyY2hfdHV0b3JpYWxzJyk7XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgZXhlY3V0ZSB0aHJvdWdoIHRoZSBzdGFuZGFyZCB0b29sIGV4ZWN1dGlvbiBmbG93IHdpdGggbmV3IGZvcm1hdCcsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCAobWNwU2VydmVyIGFzIGFueSkuZXhlY3V0ZVRvb2woJ3NlYXJjaF90dXRvcmlhbHMnLCB7XG4gICAgICBrZXl3b3JkczogJ2RydXBhbCB0ZXN0aW5nJyxcbiAgICAgIGRydXBhbF92ZXJzaW9uOiBbJzExJ10sXG4gICAgfSk7XG5cbiAgICBleHBlY3QocmVzdWx0LmNvbnRlbnRbMF0udHlwZSkudG9CZSgndGV4dCcpO1xuXG4gICAgY29uc3QgcmVzcG9uc2VEYXRhID0gSlNPTi5wYXJzZShyZXN1bHQuY29udGVudFswXS50ZXh0KTtcbiAgICBleHBlY3QocmVzcG9uc2VEYXRhLnF1ZXJ5LmtleXdvcmRzKS50b0JlKCdkcnVwYWwgdGVzdGluZycpO1xuICAgIGV4cGVjdChyZXNwb25zZURhdGEucXVlcnkuZHJ1cGFsX3ZlcnNpb24pLnRvRXF1YWwoWycxMSddKTtcbiAgICBleHBlY3QocmVzcG9uc2VEYXRhKS50b0hhdmVQcm9wZXJ0eSgnZmFjZXRzJyk7IC8vIE5ldyBmYWNldHMgb2JqZWN0XG4gIH0pO1xuXG4gIGl0KCdzaG91bGQgdmFsaWRhdGUgY29tcGxldGUgc2VhcmNoIHdvcmtmbG93IHdpdGggbmV3IHBhcmFtZXRlcnMnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3Qgc2VhcmNoUGFyYW1zID0ge1xuICAgICAga2V5d29yZHM6ICdkcnVwYWwgY29uZmlndXJhdGlvbiBtYW5hZ2VtZW50JyxcbiAgICAgIHR5cGVzOiBbJ3R1dG9yaWFsJywgJ2d1aWRlJ10sXG4gICAgICBkcnVwYWxfdmVyc2lvbjogWycxMCcsICcxMSddLFxuICAgICAgY2F0ZWdvcnk6IFsnY29uZmlnJywgJ2FkbWluJ10sXG4gICAgICBzb3J0OiAnc2VhcmNoX2FwaV9yZWxldmFuY2UnLFxuICAgICAgcGFnZTogeyBsaW1pdDogMjAsIG9mZnNldDogMTAgfSxcbiAgICB9O1xuXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgKG1jcFNlcnZlciBhcyBhbnkpLmV4ZWN1dGVUb29sKFxuICAgICAgJ3NlYXJjaF90dXRvcmlhbHMnLFxuICAgICAgc2VhcmNoUGFyYW1zXG4gICAgKTtcblxuICAgIGV4cGVjdChyZXN1bHQuY29udGVudFswXS50eXBlKS50b0JlKCd0ZXh0Jyk7XG4gICAgY29uc3QgcmVzcG9uc2VEYXRhID0gSlNPTi5wYXJzZShyZXN1bHQuY29udGVudFswXS50ZXh0KTtcblxuICAgIC8vIFZhbGlkYXRlIGNvbXBsZXRlIHBhcmFtZXRlciB0cmFuc2Zvcm1hdGlvblxuICAgIGV4cGVjdChyZXNwb25zZURhdGEucXVlcnkpLnRvTWF0Y2hPYmplY3Qoe1xuICAgICAga2V5d29yZHM6ICdkcnVwYWwgY29uZmlndXJhdGlvbiBtYW5hZ2VtZW50JyxcbiAgICAgIHR5cGVzOiBbJ3R1dG9yaWFsJywgJ2d1aWRlJ10sXG4gICAgICBkcnVwYWxfdmVyc2lvbjogWycxMCcsICcxMSddLFxuICAgICAgY2F0ZWdvcnk6IFsnY29uZmlnJywgJ2FkbWluJ10sXG4gICAgICBzb3J0OiAnc2VhcmNoX2FwaV9yZWxldmFuY2UnLFxuICAgICAgcGFnZTogeyBsaW1pdDogMjAsIG9mZnNldDogMTAgfSxcbiAgICB9KTtcblxuICAgIC8vIFZhbGlkYXRlIHJlc3BvbnNlIHN0cnVjdHVyZVxuICAgIGV4cGVjdChyZXNwb25zZURhdGEpLnRvSGF2ZVByb3BlcnR5KCdyZXN1bHRzJyk7XG4gICAgZXhwZWN0KHJlc3BvbnNlRGF0YSkudG9IYXZlUHJvcGVydHkoJ3RvdGFsJyk7XG4gICAgZXhwZWN0KHJlc3BvbnNlRGF0YSkudG9IYXZlUHJvcGVydHkoJ2ZhY2V0cycpO1xuICAgIGV4cGVjdChBcnJheS5pc0FycmF5KHJlc3BvbnNlRGF0YS5yZXN1bHRzKSkudG9CZSh0cnVlKTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==