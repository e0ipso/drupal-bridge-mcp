{"version":3,"names":["cov_74bocsu8f","path","hash","global","Function","gcv","coverageData","statementMap","start","line","column","end","fnMap","name","decl","loc","branchMap","type","locations","s","f","b","inputSourceMap","file","mappings","names","sources","sourcesContent","version","_coverageSchema","coverage","actualCoverage","DiscoveryErrorType","exports","DiscoveryError","Error","cause","constructor","message"],"sources":["/workspace/src/auth/types.ts"],"sourcesContent":["/**\n * TypeScript interfaces for OAuth 2.1 endpoint discovery and metadata\n */\n\n/**\n * OAuth 2.0 Authorization Server Metadata as defined by RFC8414\n * https://tools.ietf.org/html/rfc8414#section-2\n */\nexport interface OAuthServerMetadata {\n  /** The authorization server's issuer identifier */\n  issuer: string;\n\n  /** URL of the authorization server's authorization endpoint */\n  authorization_endpoint: string;\n\n  /** URL of the authorization server's token endpoint */\n  token_endpoint: string;\n\n  /** URL of the authorization server's JWK Set document */\n  jwks_uri?: string;\n\n  /** JSON array containing a list of OAuth 2.0 scope values supported */\n  scopes_supported?: string[];\n\n  /** JSON array containing a list of PKCE code challenge methods supported */\n  code_challenge_methods_supported?: string[];\n\n  /** JSON array containing a list of response types supported */\n  response_types_supported?: string[];\n\n  /** JSON array containing a list of grant types supported */\n  grant_types_supported?: string[];\n\n  /** JSON array containing a list of token endpoint authentication methods */\n  token_endpoint_auth_methods_supported?: string[];\n\n  /** URL of the authorization server's revocation endpoint */\n  revocation_endpoint?: string;\n\n  /** URL of the authorization server's introspection endpoint */\n  introspection_endpoint?: string;\n}\n\n/**\n * Resolved OAuth endpoints for client use\n */\nexport interface OAuthEndpoints {\n  /** The authorization endpoint URL */\n  authorizationEndpoint: string;\n\n  /** The token endpoint URL */\n  tokenEndpoint: string;\n\n  /** The issuer identifier */\n  issuer: string;\n\n  /** When the endpoints were discovered */\n  discoveredAt: Date;\n\n  /** Whether fallback endpoints were used due to discovery failure */\n  isFallback?: boolean;\n\n  /** Additional metadata from discovery (optional) */\n  metadata?: Partial<OAuthServerMetadata>;\n}\n\n/**\n * Configuration options for endpoint discovery\n */\nexport interface DiscoveryConfig {\n  /** Base URL of the OAuth authorization server */\n  baseUrl: string;\n\n  /** Timeout for discovery requests in milliseconds (default: 5000) */\n  timeout?: number;\n\n  /** Number of retry attempts for failed requests (default: 2) */\n  retries?: number;\n\n  /** TTL for cached metadata in milliseconds (default: 3600000 = 1 hour) */\n  cacheTtl?: number;\n\n  /** Whether to validate HTTPS in production (default: true) */\n  validateHttps?: boolean;\n\n  /** Whether to enable debug logging (default: false) */\n  debug?: boolean;\n}\n\n/**\n * Cache entry for discovered metadata\n */\nexport interface CacheEntry {\n  /** The cached OAuth endpoints */\n  endpoints: OAuthEndpoints;\n\n  /** Expiration timestamp */\n  expiresAt: number;\n}\n\n/**\n * Discovery error types\n */\nexport enum DiscoveryErrorType {\n  NETWORK_ERROR = 'NETWORK_ERROR',\n  TIMEOUT_ERROR = 'TIMEOUT_ERROR',\n  INVALID_JSON = 'INVALID_JSON',\n  MISSING_REQUIRED_FIELDS = 'MISSING_REQUIRED_FIELDS',\n  HTTPS_REQUIRED = 'HTTPS_REQUIRED',\n  INVALID_URL = 'INVALID_URL',\n}\n\n/**\n * Discovery error class\n */\nexport class DiscoveryError extends Error {\n  public readonly type: DiscoveryErrorType;\n  public override readonly cause?: Error;\n\n  constructor(message: string, type: DiscoveryErrorType, cause?: Error) {\n    super(message);\n    this.name = 'DiscoveryError';\n    this.type = type;\n    this.cause = cause;\n  }\n}\n"],"mappings":"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","ignoreList":[]}